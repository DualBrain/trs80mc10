1 CLEAR200:DIMST(165),SR(165),X(1),Y(1),X,Y,R,PI,SL,DY,SX,SY,DX,NX,XT,CO,CX,CY,XX,YY,YC,XC,MC,P1
2 PI=3.1415966:MC=16384
4 CLS0:PRINT@10,"STARFINDER";
5 FORTP=1TO30:R=RND(60)+2:S=RND(28)+2:SET(R,S,5):NEXT
6 PRINT@480,"BY EUGENE VASCONI    LOADING...";
8 FORTL=1TO165:READST(TL),SR(TL):NEXT
11 PRINT@480,"PRESS ANY KEY TO BEGIN         ";
12 R=1:CX=32:CY=16:CO=8:GOSUB300:IN$=INKEY$:R=1:CX=32:CY=16:CO=4:GOSUB300:IFIN$=""THEN12
15 CO=5:CLS:SOUND200,1:REM **MENU PAGE*
16 PRINT@10,"constellations":PRINT:PRINT"(1)  TAURUS":PRINT"(2)  ORION":PRINT"(3)  URSA MINOR":PRINT"(4)  GEMINI"
17 PRINT"(5)  CANUS MAJOR":PRINT"(6)  LEO":PRINT"(7)  URSA MAJOR"
18 PRINT"(8)  SCORPIUS":PRINT"(9)  CYGNUS":PRINT"(10) PEGASUS":PRINT"(11) PISCES"
19 PRINT"(12) CASSIOPEIA":PRINT"(13) THE DIPPERS ";:INPUT"selection ";SL:IF SL<1OR SL>13 THEN15
20 ON SL GOSUB28,29,30,31,32,33,34,35,36,37,38,39,40
21 REM **** DISPLAY SEQUENCE******
23 CLS0:FORCC=WTOZ:SET(ST(CC)/4,SR(CC)/6,5):NEXTCC
24 PRINT@448,"m=MENU";:PRINT@480,"d=DATA";
25 RT$=INKEY$:IFRT$="M"THEN15
26 IFRT$="D"THEN42
27 GOTO25
28 W=1:Z=12:CD=1:RETURN
29 W=13:Z=26:CD=2:RETURN
30 W=27:Z=33:CD=3:RETURN
31 W=34:Z=49:CD=4:RETURN
32 W=50:Z=63:CD=5:RETURN
33 W=64:Z=78:CD=6:RETURN
34 W=79:Z=94:CD=7:RETURN
35 W=95:Z=110:CD=8:RETURN
36 W=111:Z=118:CD=9:RETURN
37 W=119:Z=131:CD=10:RETURN
38 W=132:Z=146:CD=11:RETURN
39 W=147:Z=151:CD=12:RETURN
40 W=152:Z=165:CD=13:RETURN
41 REM  ** DATA SELECTOR **
42 ON CD GOSUB61,64,68,71,74,77,81,84,87,91,95,99,103
44 PRINT@448,"m=MENU ";:PRINT@480,"l=LINES";
45 RT$=INKEY$:IFRT$="M"THEN15
46 IF RT$="L" THEN48
47 GOTO45
48 ON CD GOTO178,180,182,184,186,189,191,194,196,198,200,203,205
49 X(0)=ST(M)/4:Y(0)=SR(M)/6:X(1)=ST(N)/4:Y(1)=SR(N)/6:GOSUB400:X(0)=ST(N)/4:Y(0)=SR(N)/6:X(1)=ST(P)/4:Y(1)=SR(P)/6:GOSUB400
50 X(0)=ST(Q)/4:Y(0)=SR(Q)/6:X(1)=ST(R)/4:Y(1)=SR(R)/6:GOSUB400:X(0)=ST(R)/4:Y(0)=SR(R)/6:X(1)=ST(S)/4:Y(1)=SR(S)/6:GOSUB400
51 IFSK=3THEN56
52 X(0)=ST(T)/4:Y(0)=SR(T)/6:X(1)=ST(U)/4:Y(1)=SR(U)/6:GOSUB400
53 IFSK=1THEN57
54 X(0)=ST(V)/4:Y(0)=SR(V)/6:X(1)=ST(W)/4:Y(1)=SR(W)/6:GOSUB400
55 IFSK=2THEN57
56 FORLP=GGTOHH:X(0)=ST(LP)/4:Y(0)=SR(LP)/6:X(1)=ST(LP+1)/4:Y(1)=SR(LP+1)/6:GOSUB400:NEXTLP
57 FORLP=GTOH:X(0)=ST(LP)/4:Y(0)=SR(LP)/6:X(1)=ST(LP+1)/4:Y(1)=SR(LP+1)/6:GOSUB400:NEXTLP
58 PRINT@448,"m=MENU";CHR$(128);:PRINT@480,"";:FORX=1TO8:PRINTCHR$(128);:NEXT
59 A$=INKEY$:IFA$="M"THEN15
60 GOTO59
61 X=204:Y=30:N$="TAURUS":GOSUB110:X=199:Y=45:N$="THE BULL":GOSUB110
62 X=43:Y=96:N$="aldebaran":GOSUB110:X=14:Y=35:N$="horns":GOSUB110:X=176:Y=140:N$="legs":GOSUB110
63 RETURN
64 PRINT@0,"ORION";:PRINT@32,"THE HUNTER";
65 PRINT@INT(159/8)+(INT(138/12)*32)+1,"rigel";:PRINT@INT(190/8)+(INT(63/12)*32)+1,"arm";
66 PRINT@INT(82/8)+(INT(109/12)*32),"belt";:PRINT@INT(66/8)+(INT(52/12)*32),"arm";
67 RETURN
68 X=178:Y=20:N$="URSA MINOR":GOSUB110:X=170:Y=32:N$="LITTLE BEAR":GOSUB110:X=158:Y=42:N$="LITTLE DIPPER":GOSUB110
69 X=51:Y=52:N$="polaris":GOSUB110:X=188:Y=117:N$="head":GOSUB110:X=40:Y=100:N$="tail":GOSUB110
70 RETURN
71 X=19:Y=135:N$="GEMINI":GOSUB110:DRAWX=27:Y=150:N$="THE TWINS":GOSUB110
72 X=6:Y=43:N$="pollux":GOSUB110:X=20:Y=16:N$="castor":GOSUB110
73 RETURN
74 X=11:Y=20:N$="CANUS":GOSUB110:X=11:Y=35:N$="MAJOR":GOSUB110
75 X=12:Y=47:N$="GREAT DOG":GOSUB110:X=149:Y=43:N$="sirius":GOSUB110:X=197:Y=66:N$="mirzam":GOSUB110
76 RETURN
77 PRINT@0,"LEO";:PRINT@32,"THE LION";
78 X=161:Y=88:N$="algieba":GOSUB110:X=177:Y=140:N$="regulus":GOSUB110
79 X=204:Y=55:N$="head":GOSUB110:X=14:Y=115:N$="tail":GOSUB110
80 RETURN
81 X=9:Y=20:N$="URSA MAJOR":GOSUB110
82 X=10:Y=30:N$="GREAT BEAR":GOSUB110:X=26:Y=100:N$="big"+CHR$(128)+"dipper":GOSUB110
83 X=153:Y=100:N$="merak":GOSUB110:X=109:Y=65:N$="dubhe":GOSUB110:RETURN
84 X=9:Y=20:N$="SCORPIUS":GOSUB110
85 X=93:Y=54:N$="antares":GOSUB110:X=25:Y=115:N$="schaula":GOSUB110:X=200:Y=52:N$="claws":GOSUB110
86 X=26:Y=150:N$="tail":GOSUB110:RETURN
87 X=9:Y=15:N$="CYGNUS":GOSUB110
88 X=10:Y=25:N$="THE SWAN":GOSUB110:X=10:Y=35:N$="NORTHERN CROSS":GOSUB110
89 X=114:Y=53:N$="deneb":GOSUB110:X=131:Y=87:N$="sadr":GOSUB110:X=186:Y=166:N$="head":GOSUB110
90 X=190:Y=50:N$="wing":GOSUB110:X=44:Y=135:N$="wing":GOSUB110:RETURN
91 X=9:Y=20:N$="PEGASUS":GOSUB110:X=104:Y=15:N$="WINGED HORSE":GOSUB110
92 X=124:Y=66:N$="markab":GOSUB110:X=117:Y=120:N$="scheat":GOSUB110:X=171:Y=82:N$="algenib":GOSUB110
93 X=44:Y=59:N$="head":GOSUB110:X=4:Y=120:N$="front"+CHR$(128)+"legs":GOSUB110
94 RETURN
95 X=9:Y=20:N$="PISCES":GOSUB110:X=90:Y=15:N$="THE FISHES":GOSUB110
96 X=22:Y=115:N$="alrischa":GOSUB110:X=126:Y=58:N$="fish":GOSUB110:X=190:Y=115:N$="fish":GOSUB110
97 X=30:Y=155:N$="fish"+CHR$(128)+"are"+CHR$(128)+"connected"+CHR$(128)+"by"+CHR$(128)+"a"+CHR$(128)+"rope":GOSUB110
98 RETURN
99 X=9:Y=30:N$="CASSIOPEIA":GOSUB110
100 X=189:Y=108:N$="caph":GOSUB110:X=154:Y=137:N$="schedir":GOSUB110
101 X=8:Y=112:N$="knee"+CHR$(128)+"of"+CHR$(128)+"woman":GOSUB110:X=30:Y=120:N$="on"+CHR$(128)+"throne":GOSUB110
102 RETURN
103 X=10:Y=104:N$="LITTLE DIPPER":GOSUB110:X=158:Y=140:N$="BIG DIPPER":GOSUB110
104 X=39:Y=28:N$="polaris":GOSUB110:X=192:Y=60:N$="pointers":GOSUB110
105 REM LINE(180,74)-(200,62),PSET:LINE-(196,80),PSET:FOREY=1TO50:NEXTEY:COLOR1:LINE(180,74)-(200,62),PSET:LINE-(196,80),PSET:COLOR0:NEXTEX
106 REM LINE(174,76)-(91,28),PSET:COLOR0:FOREY=1TO50:NEXTEY:LINE(174,76)-(91,28),PSET:COLOR1:NEXTEX
107 CO=4:X(0)=93/4:Y(0)=25/6:X(1)=155/4:Y(1)=25/6:GOSUB400:X(0)=155/4:Y(0)=25/6:X(1)=173/4:Y(1)=73/6:GOSUB400:CO=5
108 X=156:Y=10:N$="5":GOSUB110:GOSUB600:PRINTCHR$(128)+"times";:X=132:Y=20:N$="pointer"+CHR$(128)+"distance":GOSUB110:RETURN
109 REM  **LABEL SUBROUTINE**
110 PRINT@INT(X/8)+(INT(Y/12)*32),N$;
111 RETURN
150 REM  **STAR POSITIONS**
151 REM TAURUS
152 DATA40,52,96,84,112,84,140,100,184,96,108,76,102,68,52,20,192,112,144,136,120,120,100,112
153 REM ORION
154 DATA176,36,183,56,184,64,183,68,180,84,140,68,128,52,100,60,116,104,124,100,132,95,152,132,108,140,88,48
155 REM URSA MINOR
156 DATA43,48,61,78,89,107,134,119,135,142,180,140,179,114
157 REM GEMINI
158 DATA44,49,62,61,92,105,124,118,183,156,164,186,77,52,42,80,70,18,82,20,115,36,168,80,232,102,201,122,152,6,84,54
159 REM CANUS MAJOR
160 DATA120,180,104,148,98,138,86,125,118,108,157,70,141,45,124,6,102,34,98,104,190,60,182,166,73,128,53,150
161 REM LEO
162 DATA14,150,66,106,84,104,150,66,192,34,203,44,228,41,231,18,59,172,73,134,184,125,173,100,244,130,149,88,145,160
163 REM URSA MAJOR
164 DATA15,95,44,80,70,84,96,84,110,101,149,90,146,67,198,43,236,37,197,63,224,89,248,90,249,98,156,149,204,176,207,160
165 REM SCORPIUS
166 DATA74,120,61,133,54,141,70,161,98,156,114,144,114,118,116,100,138,66,148,56,191,19,195,36,192,60,188,75,162,54,69,120
167 REM CYGNUS
168 DATA99,47,114,79,139,108,173,160,182,23,163,59,74,106,32,118
169 REM PEGASUS
170 DATA83,125,103,114,115,108,157,110,164,72,114,71,101,66,96,63,80,57,64,106,76,103,103,95,105,98
171 REM PISCES
172 DATA81,107,92,91,100,78,104,69,110,58,111,46,104,54,116,95,125,96,154,96,167,98,175,95,183,102,178,107,167,106
173 REM CASSIOPEIA
174 DATA66,61,91,95,124,93,144,129,181,102
175 REM DIPPERS
176 DATA89,26,80,38,73,52,76,68,67,74,78,89,84,82,133,162,138,138,151,126,166,110,183,112,194,85,176,76
177 REM ***CONNECT INFO***
178 M=9:N=5:P=10:Q=11:R=4:S=12:T=3:U=6:SK=1:G=1:H=7
179 GOTO49
180 Q=25:R=21:S=20:T=20:U=26:V=23:W=18:SK=2:G=13:H=23
181 GOTO50
182 V=30:W=33:G=27:H=32:SK=2
183 GOTO54
184 M=40:N=35:P=41:Q=48:R=43:S=49:T=39:U=36:V=47:W=45:G=34:H=37:GG=42:HH=45:SK=0
185 GOTO49
186 X(0)=ST(58)/4:Y(0)=SR(58)/6:X(1)=ST(56)/4:Y(1)=SR(56)/6:GOSUB400:X(0)=ST(56)/4:Y(0)=SR(56)/6:X(1)=ST(59)/4:Y(1)=SR(59)/6
187 GOSUB400:M=59:N=53:P=61:Q=53:R=62:S=63:T=60:U=55:SK=1:G=50:H=57
188 GOTO49
189 M=75:N=77:P=67:Q=65:R=73:S=78:G=64:H=70:GG=72:HH=75:SK=3
190 GOTO49
191 X(0)=ST(85)/4:Y(0)=SR(85)/6:X(1)=ST(82)/4:Y(1)=SR(82)/6:GOSUB400:X(0)=ST(83)/4:Y(0)=SR(83)/6:X(1)=ST(92)/4:Y(1)=SR(92)/6
192 GOSUB400:M=94:N=92:P=93:Q=86:R=88:S=89:T=89:U=91:V=84:W=88:G=79:H=84:GG=85:HH=89:SK=0
193 GOTO49
194 Q=107:R=108:S=104:T=104:U=109:G=95:H=105:SK=1
195 GOTO50
196 Q=115:R=116:S=112:T=112:U=117:V=117:W=118:G=111:H=113:SK=2
197 GOTO50
198 Q=131:R=121:S=124:G=128:H=130:GG=119:HH=126:SK=3
199 GOTO50
200 X(0)=ST(139)/4:Y(0)=SR(139)/6:X(1)=ST(132)/4:Y(1)=SR(132)/6:GOSUB400
201 T=146:U=142:V=138:W=136:G=139:H=145:GG=132:HH=137:SK=0
202 GOTO52
203 G=147:H=150
204 GOTO57
205 T=165:U=162:V=158:W=155:GG=159:HH=164:G=152:H=157:SK=0
206 GOTO52
300 REM CX=CENTRE X CY=CENTER Y R=RADIUS12 CO=COLOR
310 XC=0:YC=R:PC=3-2*R 
335 GOSUB370
340 IFPC<0THENPC=PC+4*XC+6:GOTO350
345 PC=PC+4*(XC-YC)+10:YC=YC-1   
350 XC=XC+1
355 IFXC<YCTHEN335
360 IFXC=YCTHENGOSUB370 
365 RETURN
370 XX=CX+XC:YY=CY+YC:SET(XX,YY,CO)
371 XX=CX-XC:YY=CY+YC:SET(XX,YY,CO)
372 XX=CX+XC:YY=CY-YC:SET(XX,YY,CO)
373 XX=CX-XC:YY=CY-YC:SET(XX,YY,CO)
374 XX=CX+YC:YY=CY+XC:SET(XX,YY,CO)
375 XX=CX-YC:YY=CY+XC:SET(XX,YY,CO) 
376 XX=CX+YC:YY=CY-XC:SET(XX,YY,CO)
377 XX=CX-YC:YY=CY-XC:SET(XX,YY,CO)
379 RETURN
400 DX=X(1)-X(0):DY=Y(1)-Y(0):SX=SGN(DX):SY=SGN(DY)
440 IFDX=0THEN550
450 SL=DY/DX:B=Y(0)-SL*X(0)
460 T1=SQR(SL*SL+1)
470 NX=1/T1*SX
480 FORXT=X(0)TOX(1)STEPNX
490 X=INT(XT+.5)
500 Y=INT(SL*XT+B+.5)
510 SET(X,Y,CO)
520 NEXTXT
525 RETURN
550 X=X(0)
560 FORY=Y(0)TOY(1)STEPSY
570 SET(X,Y,CO)
580 NEXT
585 RETURN
600 P1=(PEEK(17024)AND1)*256+PEEK(17025):POKEMC+P1-1,PEEK(MC+P1-1)-64:RETURN
