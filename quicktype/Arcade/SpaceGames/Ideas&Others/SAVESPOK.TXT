10 MC=15360
20 GOSUB 1430
30 CLS:PRINT"SKILL LEVEL:",,,," 1) NOVICE",," 2) INTERMEDIATE"," 3) EXPERT",,,,"   4) no win scenario"
31 PRINT:INPUT"(1-4)";SK:IF SK<1 OR SK>4 THEN 30
32 IF SK=1 THEN TT=16000:GOTO40
33 IF SK=2 THEN TT=14000:GOTO40
34 IF SK=3 THEN TT=10000:GOTO40
35 TT=9000
40 CLS
50 REM DRAW SCREEN
60 REM
70 REM
80 P=2000:T=RND(5)+10:AP=500:MG=0
90 KP=3000
100 CD=RND(200)+500
110 SH=RND(2000)+1000
115 FOR EK=1024 TO 1215:POKEMC+EK,128:NEXTEK
120 FORA=1216TO1247:POKEMC+A,147:NEXT
130 FORA=1023TO1247STEP32:POKEMC+A,149:NEXT
140 FORA=1056TO1247STEP32:POKEMC+A,154:NEXT
150 FORA=1024TO1055:POKEMC+A,156:NEXT
155 POKEMC+1036,78:POKEMC+1037,67:POKEMC+1038,67:POKEMC+1039,109
156 POKEMC+1040,113:POKEMC+1041,119:POKEMC+1042,112:POKEMC+1043,113
160 POKEMC+1024,207:POKEMC+1055,207:POKEMC+1216,207:POKEMC+1247,207
170 POKEMC+1230,155:POKEMC+1233,151
180 POKEMC+1222,159:POKEMC+1241,159
190 POKEMC+1080,194:POKEMC+1081,191
200 POKEMC+1065,194:POKEMC+1195,194
205 TIMER=0
210 REM MAIN SEQUENCE
220 FORA=1121TO1150:POKEMC+A,128:NEXT
230 S=0:TIMER=TIMER+1
240 IF P<=0 THEN P=0
250 IF AP<=0 THEN AP=0
260 PRINT@224,"PHASER POWER:";P:PRINT@256,"PHOTON TORPEDOES:";T
270 IF P<=0 THEN P=0
280 IF T<=0 THEN T=0
290 PRINT@224,"PHASER POWER:";P;
300 PRINT@256,"PHOTON TORPEDOES:";T
310 PRINT@288,"AUX. POWER:";AP
320 PRINT@320,"SHIELDS:";:IFS=1THENPRINT"UP":GOTO330
321 PRINT"DOWN"
330 PRINT@352, " "
340 IF KP<CD THEN PRINT@352,"cloaking device engaged"
350 PRINT@384,"KLINGON POWER:";KP
360 PRINT@448," p=PHASERS o=PHOTONS s=SHIELDS"
370 IF KP<50 THEN GOSUB1190
380 IF P<50 AND AP<25 THEN GOSUB1110
390 IF TIMER>TT THEN GOSUB 1290
395 IFMG=0THEN396
396 GOTO400
396 FORA=1TO999:NEXT
397 MG=1
400 REM KLINGONS MOVE
410 KM=RND(24)+1122:IFKM<=1122ORKM>=1148THEN410
420 RK=RND(2):IFRK=1THEN430
421 GOTO510
430 FORE=KMTO1148:POKEMC+E,134:POKEMC+E+1,137:POKEMC+E-1,128:N=RND(200):IFN/20=INT(N/20)THEN590
440 A$=INKEY$:IFA$=""THEN490
450 IF A$="S" THEN SH=SH-100:GOTO440
460 IF A$="P"THEN GOSUB680
470 IF A$="O"THENGOSUB790
480 GOTO 210
490 NEXTE
500 GOTO 210
510 FORE=KMTO1122STEP-1:POKEMC+E,134:POKEMC+E+1,137:POKEMC+E+2,128:N=RND(200):IFN/20=INT(N/20)THEN590
520 A$=INKEY$:IFA$=""THEN570
530 IF A$="S" THENSH=SH-100:GOTO520
540 IF A$="P"THENGOSUB680
550 IF A$="O"THENGOSUB790
560 GOTO210
570 NEXTE
580 GOTO210
590 REM KLINGONS ATTACK
600 IF KP<CD THEN GOTO 370
610 FORA=1TO5:SOUND200,1:NEXTA
620 B=1:POKEMC+E+32,186:POKEMC+E+33,181:POKEMC+E+64,186:POKEMC+E+65,181:FORA=1TO25:NEXTA
621 POKEMC+E+32,128:POKEMC+E+33,128:POKEMC+E+64,128:POKEMC+E+65,128
630 A$=INKEY$:IF A$=""THENB=B+1:IFB>5THENGOTO650
631 GOTO630
640 IFA$="S"THENGOSUB900
650 IFA$<>"S"THENGOSUB1030
660 GOTO 210
670 GOTO 210
680 REM PHASER ATTACK ON KLINGONS
690 IFP<=0THENAP=AP-50
700 PRINT@352,"phasers fired"
710 POKEMC+1198,182:POKEMC+1201,185:FORA=1TO 100:NEXTA:POKEMC+1198,128:POKEMC+ 1201,128
720 FORA=30TO1STEP-2:SOUNDA,1:NEXTA
730 IFE<1133ORE>1137THENPRINT@352,"target missed":SOUND10,5:P=P-50:FORA=1TO1000:NEXTA:GOTO210
740 P=P-50
750 KP=KP-(RND(10)+90)
760 PRINT@352,"direct hit!":FORA=1TO5:SOUND200,1:SOUND220,1:NEXTA:
770 FORA=176TO192:POKEMC+E,A:SOUNDRND(200),1:NEXT
780 RETURN
790 REM PHOTON ATTACK ON KLINGONS
800 IF T=0THEN SOUND10,5:PRINT@352,"torpedoes depleted":FORA=1TO1000:NEXTA:RETURN
810 SOUND200,5:PRINT@352,"torpedoe fired":POKEMC+1190,188:POKEMC+1209,188:SOUND225,1:POKEMC+1190,128
811 POKEMC+1209,128:POKEMC+1158,188:POKEMC+1177,188:SOUND125,1:POKEMC+1158,128:POKEMC+1177,128
820 IFE=1125ORE=1126ORE=1144ORE=1145THEN830
821 GOTO870
830 PRINT@352,"target hit!"
840 IFE=1125THENE=1126
850 IFE=1144THENE=1145
860 FORA=177TO192:POKEMC+E,A:SOUNDRND(200),1:NEXTA:T=T-1:KP=KP-(RND(150)+100):RETURN
870 SOUND10,5:PRINT@352,"target missed":FORA=1TO1000:NEXTA
880 T=T-1
890 RETURN
900 REM SHIELDS UP
910 S=1:IFSH>100ORAP>100THENPRINT@328,"UP":GOTO920
911 GOTO930
920 SH=SH-100
930 IF SH<=0AND AP<=0THENSOUND100,5:PRINT@328,"damaged":GOTO1040
940 SOUND200,1:IF SH<=0 THEN AP=AP-100:MR=1
950 PRINT@352,"incoming klingon phaser!!"
955 IF MR=1 THEN PRINT@328,"UP"
960 P=P-(RND(25)+50):AP=AP-(RND(3)*10)
970 KP=KP-50
980 FORX=30TO1STEP-2:POKE49151,64:FORZZ=1TO5:NEXT:SOUNDX,1:NEXT
982 POKE49151,0
990 PRINT@352,"damage report:slight"
1000 FORA=1TO800:NEXT
1010 IFSH<=0THENAP=AP-100
1020 RETURN
1030 REM SHIELDS DOWN
1040 P=P-(RND(150)+100):AP=AP-((RND(100))+50)
1050 PRINT@352,"incoming klingon phaser!!!"
1060 FORA=1TO30:SOUNDA,1:NEXTA
1070 PRINT@352,"damage report:heavy"
1080 KP=KP-50
1090 FORA=1TO800:NEXTA
1100 RETURN
1110 SOUND1,10
1120 PRINT@224,"THE KLINGONS HAVE DAMAGED THE   ENTERPRISE BEYOND REPAIR."
1130 SS=0
1140 PRINT"PRESS <r> FOR MISSION REPORT."
1145 PRINT
1150 A$=INKEY$:IF A$=""THEN 1150
1160 IF A$<>"R"ANDA$<>"D"THEN1150
1170 IF A$="D" THEN GOSUB 1740
1180 GOTO 1350
1190 REM KLINGONS DEAD
1200 SOUND 200,10
1210 PRINT@224,"THE KLINGON SHIP HAS BEEN DIS-  ABLED. YOU MAY PROCEED ON COURSE TO VULCAN."
1220 SS=1
1230 PRINT"PRESS <r> FOR MISSION REPORT"
1235 PRINT
1240 A$=INKEY$:IF A$=""THEN1240
1250 IFA$<>"R"THEN1240
1260 GOTO1350
1270 CLS:FOR T=127TO255:PRINT T;CHR$(T);:NEXT
1280 REM SPOCK DEAD
1290 SOUND100,5:SOUND200,5:SOUND100,5:PRINT@224,"report from sick bay:
1300 PRINT "TIME HAS RUN OUT.               DAMN IT,JIM! SPOCK IS DEAD."
1310 SS=0:PRINT"PRESS <r> FOR MISSION REPORT."
1315 PRINT
1320 A$=INKEY$:IFA$=""THEN1320
1330 IFA$<>"R"THEN1320
1340 GOTO 1350
1350 CLS:SOUND200,1:PRINT "MISSION REPORT:"
1360 PRINT"********************************"
1370 PRINT "POWER LEFT ON ENTERPRISE:";:IF AP+P<=0THEN PRINT " NONE":GOTO1380
1371 PRINT AP+P
1380 PRINT:IF T>0 THEN PRINT "TORPEDOES LEFT:";T:PRINT
1390 IF SS=1 THEN PRINT "MR.SPOCK HAS BEEN BEAMED TO     VULCAN":GOTO1400
1391 PRINT "MR. SPOCK IS DEAD"
1400 PRINT:IF AP+P>100 AND SS=1 THEN PRINT "THE FEDERATION SALUTES YOU!":GOTO1410
1401 PRINT "JIM, BABY, YOU'RE TOO OLD TO    RUN A STARSHIP."
1410 PRINT:PRINT"<HIT ANY KEY TO PLAY AGAIN>"
1420 A$=INKEY$:IFA$=""THEN1420
1421 GOTO30
1430 CLS:REM BEGINNING
1440 PRINT@353,"     ''BATTLE AT VULCAN ''"
1450 REM
1460 FORA=1TO1000:NEXT
1470 SOUND200,1:CLS:PRINT "YOU ARE CAPTAIN JAMES T. KIRK"
1471 PRINT"OF THE UNITED STARSHIP"
1472 PRINT"ENTERPRISE. YOUR FIRST OFFICER,"
1473 PRINT"MR. SPOCK, HAS BLOOD FEVER AND "
1474 PRINT"YOU ARE ON A COURSE TO HIS     "
1475 PRINT"HOME PLANET, VULCAN."
1480 PRINT:PRINT"<HIT ANY KEY TO CONTINUE>"
1490 A$=INKEY$:IFA$=""THEN 1490
1500 SOUND 200,1:CLS
1501 PRINT"YOU ARE JUST OUTSIDE OF VULCAN"
1502 PRINT"WHEN A KLINGON BATTLE CRUISER"
1503 PRINT"BLOCKS YOU AND BEGINS FIRING."
1510 PRINT:PRINT"<HIT ANY KEY TO CONTINUE>"
1520 A$=INKEY$:IFA$=""THEN1520
1530 SOUND 200,1:CLS
1531 PRINT"YOUR COURSE OF ACTION IS CLEAR:"
1532 PRINT"YOU MUST DESTROY THE KLINGON   "
1533 PRINT"SHIP AND RUSH SPOCK TO VULCAN."
1540 PRINT:PRINT"TIME IS OF THE ESSENCE:SPOCK IS DYING"
1550 PRINT:PRINT"<HIT ANY KEY TO CONTINUE>"
1560 A$=INKEY$:IFA$=""THEN1560
1570 SOUND200,1:CLS
1571 PRINT"A WORD OF CAUTION:WHEN THE"
1572 PRINT"KLINGONS FEEL THEY ARE LOW"
1573 PRINT"ON POWER, THEY WILL STOP"
1574 PRINT"FIRING AND ENGAGE THEIR"
1575 PRINT"CLOAKING DEVICE, WHICH          WILL PROJECT A FALSE SHADOW     OF THEIR SHIP."
1580 PRINT:PRINT "YOU MAY WASTE POWER FIRING AT A KLINGON SHIP THAT IS NO LONGER  WHERE IT SEEMS TO BE."
1590 PRINT:PRINT "<HIT ANY KEY TO CONTINUE>"
1600 A$=INKEY$:IFA$=""THEN 1600
1610 SOUND 200,1:CLS:PRINT"YOUR OPTIONS:":PRINT"********************************"
1620 PRINT:PRINT"<P>=PHASERS. ACCURATE WHEN            WITHIN TARGET RANGE":PRINT
1630 PRINT "<O>=PHOTON TORPEDOES. MORE            POWERFUL, BUT SMALLER             TARGET RANGE."
1640 PRINT:PRINT"<S>=SHIELDS. MUST BE UP                DIRECTLY AFTER KLINGON             FIRE."
1650 PRINT"<HIT ANY KEY TO PLAY>"
1660 A$=INKEY$:IF A$=""THEN1660
1670 CLS:SOUND200,1:PRINT "PLEASE ENTER THREE WORDS <ONE   AT A TIME> THAT WILL BE YOUR    SELF-DESTRUCT CODE."
1680 PRINT"IF AND ONLY IF YOU ARE DEFEATED BY THE KLINGONS, YOU MAY CHOOSE TO BLOW UP THE ENTERPRISE BY"
1681 PRINT"PRESSING <D> AND ENTERING YOUR  CODE. THE KLINGONS WILL HAVE 60 SECONDS TO SURRENDER OR DIE"
1682 PRINT"ALONG WITH YOU."
1690 :PRINT
1700 INPUT "#1:";D$(1)
1710 INPUT "#2:";D$(2)
1720 INPUT "#3:";D$(3)
1730 RETURN
1740 PRINT@224," "
1750 PRINT:PRINT:PRINT:PRINT
1760 POKEMC+1134,214:POKEMC+1135,217
1770 PRINT@224,"PLEASE ENTER DESTRUCT CODE"
1780 POKEMC+65496,0:INPUT F$(1),F$(2),F$(3)
1790 IFF$(1)<>D$(1)ORF$(2)<>D$(2)ORF$(3)<>D$(3)THENPRINT@224,"INVALID DESTRUCT CODE":SOUND 10,20:FORX=1TO2000:NEXT:RUN
1800 PRINT@224," ":PRINT:PRINT:PRINT:PRINT
1810 SOUND 200,10:PRINT "DESTRUCT SEQUENCE COMMENCING"
1820 FORA=30TO0STEP-1
1830 SOUND200,1:PRINT@355,A
1840 B=RND(350)
1850 IF B=150 THEN SOUND10,10:PRINT@224,"THE KLINGONS HAVE SURRENDERED   THEIR VESSEL.":FORX=1TO3000:NEXT:RUN
1860 FORH=1TO 300:NEXTH
1870 NEXT A
1890 CLS
1900 POKEMC+65497,0:FORX=1TO50:PALETTE13,RND(63):PLAY"L255;O1;V"+STR$(RND(31))+";EFGE":NEXT
1901 PALETTE13,0:FORX=1TO1000:NEXT
1902 CLS:PRINT" AFTER AN INTENSE EXPLOSION YOU NO LONGER FEEL OR SEE ANYTHING."
1903 PRINT"THEN SUDDENLY YOU SEEM TO HEAR YOUR OWN HEART...":FORX=1TO1000:NEXT
1905 Y=100
1908 FORV=1TO31STEP1.5:SOUNDV,1:FORX=1TOY:NEXTX:FORX=1TOY*3:NEXTX:NEXTV
1910 FORX=1TOY:NEXTX:IF Y>950 THEN 1915
1911 SOUNDY,1:FORX=1TOY*3:NEXTX:Y=Y+Y/10:GOTO1910
1915 FORX=1TO2000:NEXT
1920 READZ:IF Z=0 THEN FORI=0TO15:NEXT:END
1921 SOUNDZ,1:FOR X=1 TO 40:NEXT:GOTO1920
1930 DATA 62,59,58,30,56,24,21,6,7,2,3,5,1,0
2000 PRINT"Spock is ";:IF TIMER>TT THEN PRINT"dead,":GOTO2020
2001 PRINT"dying,"
2020 PRINT"The universe is a mess,"
2030 PRINT"You're supposed to BOLDLY go where no   one in their right mind has gone        before..."
2040 PRINT:PRINT:PRINT"   AND YOU'RE QUITTING???":PRINT:PRINT:PRINT
2050 PR$="Say What?"+CHR$(13)+CHR$(0)
2060 L=LEN(PR$):FOR I=1 TO L:POKEMC+1024+I,ASC(MID$(PR$,I,1)):NEXTI
9999 END
10000 FORT=128TO255:PRINTT;CHR$(T):PRINT:NEXT
