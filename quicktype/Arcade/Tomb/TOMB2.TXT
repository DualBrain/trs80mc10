0 CLS:DIMA$(4,4),B$(4,4),C$(4,4),D$(4,4),P(31,15),X(6),Y(6),T(6),K(255),S(2,2,6),D(4,2),C(4,2),V(6),W(6),U(6),F(6),O:GOTO999
1 ONTGOTO11:GOTO8
2 ONTGOTO12:RETURN:REM MONSTER TOUCHES A KEY
3 RETURN:REM BLUE
4 U(T)=0:V(T)=0:W(T)=0:RETURN:REM RED
5 RETURN:REM WHITE (SHOT)
6 STOP:RETURN:REM PLAYER TOUCHED BY MONSTER
7 RETURN:REM PURPLE (MAGICAL ITEM)
8 F(T)=S(SGN(X(T)-X(1))+1,SGN(Y(T)-Y(1))+1,RND(6)):Q(T)=C(F(T),1):R(T)=C(F(T),2):V(T)=D(F(T),1):W(T)=D(F(T),2)
9 U(T)=V(T)+32*W(T):ONK(PEEK(M+P+Q(T)))GOSUB1,2,3,4,5,6,7,4:ONK(PEEK(M+P+R(T)))GOSUB1,2,3,4,5,6,7,4:RETURN
11 RETURN:REM PLAYER TOUCHING A MONSTER
12 RETURN:REM PLAYER TOUCHING KEY
20 FORT=1TO5:O=X(T)+32*Y(T):X(T)=X(T)+V(T):Y(T)=Y(T)+W(T):P=O+U(T)
21 PRINT@O,B$;:PRINT@O+32,B$;:PRINT@P,A$(T(T),F(T));:PRINT@P+32,B$(T(T),F(T));
22 ONK(PEEK(M+P+Q(T)))GOSUB1,2,3,4,5,6,7,8:ONK(PEEK(M+P+R(T)))GOSUB1,2,3,4,5,6,7,8
25 PRINT@P,C$(T(T),F(T));:PRINT@P+32,D$(T(T),F(T));:NEXT:GOTO20
200 FORY=0TO15:FORX=0TO31
210 P(X,Y)=Y*32+X:NEXT:NEXT
300 CLS0:FORX=0TO30:PRINT@P(X,0),CHR$(255);:PRINT@P(X,15),CHR$(255);:NEXT
310 FORY=0TO14:PRINT@P(0,Y),CHR$(255);:PRINT@P(31,Y),CHR$(255);:NEXT:POKEM+480,255:POKEM+511,255
400 FORT=1TO6:X(T)=RND(29):Y(T)=RND(13):T(T)=RND(3)+1:F(T)=RND(2)
410 Q(T)=C(F(T),1):R(T)=C(F(T),2):V(T)=D(F(T),1):W(T)=D(F(T),2):U(T)=V(T)+32*W(T)
420 NEXT:T(1)=1
500 GOTO20
650 I$=INKEY$:ON1-(I$<>"")GOTO650:RETURN
999 T=0:Z=0:M=16384:B$=CHR$(128)+CHR$(128)
1000 A$(2,1)="Åè":A$(2,2)="èÇ":A$(1,1)="”€":A$(1,2)="◊”":A$(3,1)="çÄ":A$(3,2)="Äé":A$(4,1)="Üâ":A$(4,2)="Üâ"
1010 B$(2,1)="Äá":B$(2,2)="ãÄ":B$(1,1)="—Ÿ":B$(1,2)="÷“":B$(3,1)="Öá":B$(3,2)="ãä":B$(4,1)="ÄÄ":B$(4,2)="ÄÄ"
1020 C$(2,1)="áä":C$(2,2)="Öã":C$(1,1)="”€":C$(1,2)="◊”":C$(3,1)="ÉÅ":C$(3,2)="ÇÉ":C$(4,1)="âÜ":C$(4,2)="âÜ"
1030 D$(2,1)="Åâ":D$(2,2)="ÜÇ":D$(1,1)="—Ÿ":D$(1,2)="÷“":D$(3,1)="Öá":D$(3,2)="ãä":D$(4,1)="ÄÄ":D$(4,2)="ÄÄ"
1040 A$(2,3)="Åè":A$(2,4)="èÇ":A$(1,3)="”€":A$(1,4)="◊”":A$(3,3)="çÄ":A$(3,4)="Äé":A$(4,3)="Üâ":A$(4,4)="Üâ"
1050 B$(2,3)="Äá":B$(2,4)="ãÄ":B$(1,3)="—Ÿ":B$(1,4)="÷“":B$(3,3)="Öá":B$(3,4)="ãä":B$(4,3)="ÄÄ":B$(4,4)="ÄÄ"
1060 C$(2,3)="áä":C$(2,4)="Öã":C$(1,3)="”€":C$(1,4)="◊”":C$(3,3)="ÉÅ":C$(3,4)="ÇÉ":C$(4,3)="âÜ":C$(4,4)="âÜ"
1070 D$(2,3)="Åâ":D$(2,4)="ÜÇ":D$(1,3)="—Ÿ":D$(1,4)="÷“":D$(3,3)="Öá":D$(3,4)="ãä":D$(4,3)="ÄÄ":D$(4,4)="ÄÄ"
1099 S(1,1,1)=1:S(1,1,2)=2:A=1:B=1:GOSUB1200
1100 S(2,2,1)=1:S(2,2,2)=3:A=2:B=2:GOSUB1200
1110 S(2,1,1)=1:S(2,1,2)=1:A=2:B=1:GOSUB1200
1120 S(1,2,1)=3:S(1,2,2)=3:A=1:B=2:GOSUB1200
1130 S(0,0,1)=2:S(0,0,2)=4:A=0:B=0:GOSUB1200
1140 S(0,1,1)=2:S(0,1,2)=2:A=0:B=1:GOSUB1200
1150 S(1,0,1)=4:S(1,0,2)=4:A=1:B=0:GOSUB1200
1160 S(0,2,1)=2:S(0,2,2)=3:A=0:B=2:GOSUB1200
1170 S(2,0,1)=1:S(2,0,2)=4:A=2:B=0:GOSUB1200
1190 GOTO1300
1200 FORT=1TO4:S(A,B,2+T)=T:NEXT:RETURN
1300 D(1,1)=-1:D(1,2)=0
1310 D(2,1)=1:D(2,2)=0
1320 D(3,1)=0:D(3,2)=-1
1330 D(4,1)=0:D(4,2)=1
1400 C(1,1)=-1:C(1,2)=31
1410 C(2,1)=2:C(2,2)=34
1420 C(3,1)=-32:C(3,2)=-31
1430 C(4,1)=64:C(4,2)=65
1900 FORT=0TO7:FORZ=0TO15:K(128+(16*T)+Z)=T+1:NEXT:NEXT:K(128)=0
1999 GOTO200
