0 CLS:DIMT,A$(4,4,2),B$(4,4,2),X(6),Y(6),Q(6),R(6),T(6),H(6),K(255),D(4,2),C(4,2),V(6),W(6),U(6),F(6),S(2,2,6):GOTO999
1 ONTGOTO11:GOTO8
2 ONTGOTO12:RETURN:REM MONSTER TOUCHES A KEY
3 RETURN:REM BLUE
4 U(T)=0:V(T)=0:W(T)=0:RETURN:REM RED
5 RETURN:REM WHITE (SHOT)
6 STOP:RETURN:REM PLAYER TOUCHED BY MONSTER
7 RETURN:REM PURPLE (MAGICAL ITEM)
8 F(T)=S(SGN(X(T)-X(1))+1,SGN(Y(T)-Y(1))+1,RND(6)):Q(T)=C(F(T),1):R(T)=C(F(T),2):V(T)=D(F(T),1):W(T)=D(F(T),2)
9 U(T)=V(T)+32*W(T):ONK(PEEK(M+P+Q(T)))GOSUB1,2,3,4,5,6,7,4:ONK(PEEK(M+P+R(T)))GOSUB1,2,3,4,5,6,7,4:RETURN
11 STOP:RETURN:REM PLAYER TOUCHING A MONSTER
12 RETURN:REM PLAYER TOUCHING KEY
20 FORT=1TO5:O=X(T)+32*Y(T):X(T)=X(T)+V(T):Y(T)=Y(T)+W(T):P=O+U(T)
21 H(T)=H(T)*-1:PRINT@O,B$;:PRINT@O+32,B$;:PRINT@P,A$(T(T),F(T),H(T)+1);:PRINT@P+32,B$(T(T),F(T),H(T)+1);
22 ONK(PEEK(M+P+Q(T)))GOSUB1,2,3,4,5,6,7,8:ONK(PEEK(M+P+R(T)))GOSUB1,2,3,4,5,6,7,8
25 NEXT:GOTO20
200 CLS0:I$=CHR$(255):FORX=0TO30:PRINT@X,I$;:PRINT@X+480,I$;:NEXT
210 FORY=0TO14:PRINT@Y*32,I$;:PRINT@31+Y*32,I$;:NEXT:POKEM+480,255:POKEM+511,255
400 FORT=1TO6:X(T)=1+RND(28):Y(T)=1+RND(12):T(T)=RND(3)+1:F(T)=RND(2)
410 Q(T)=C(F(T),1):R(T)=C(F(T),2):V(T)=D(F(T),1):W(T)=D(F(T),2):U(T)=V(T)+32*W(T)
420 H(T)=1:NEXT:T(1)=1
500 GOTO20
650 I$=INKEY$:ON1-(I$<>"")GOTO650:RETURN
999 O=0:P=0:T=0:Z=0:M=16384:B$=CHR$(128)+CHR$(128)
1000 A$(2,1,0)="Åè":A$(2,2,0)="èÇ":A$(1,1,0)="”€":A$(1,2,0)="◊”":A$(3,1,0)="çÄ":A$(3,2,0)="Äé":A$(4,1,0)="Üâ":A$(4,2,0)="Üâ"
1010 B$(2,1,0)="Äá":B$(2,2,0)="ãÄ":B$(1,1,0)="—Ÿ":B$(1,2,0)="÷“":B$(3,1,0)="Öá":B$(3,2,0)="ãä":B$(4,1,0)="ÄÄ":B$(4,2,0)="ÄÄ"
1020 A$(2,1,2)="áä":A$(2,2,2)="Öã":A$(1,1,2)="”€":A$(1,2,2)="◊”":A$(3,1,2)="ÉÅ":A$(3,2,2)="ÇÉ":A$(4,1,2)="âÜ":A$(4,2,2)="âÜ"
1030 B$(2,1,2)="Åâ":B$(2,2,2)="ÜÇ":B$(1,1,2)="—Ÿ":B$(1,2,2)="÷“":B$(3,1,2)="Öá":B$(3,2,2)="ãä":B$(4,1,2)="ÄÄ":B$(4,2,2)="ÄÄ"
1040 A$(2,3,0)="Åè":A$(2,4,0)="èÇ":A$(1,3,0)="”€":A$(1,4,0)="◊”":A$(3,3,0)="çÄ":A$(3,4,0)="Äé":A$(4,3,0)="Üâ":A$(4,4,0)="Üâ"
1050 B$(2,3,0)="Äá":B$(2,4,0)="ãÄ":B$(1,3,0)="—Ÿ":B$(1,4,0)="÷“":B$(3,3,0)="Öá":B$(3,4,0)="ãä":B$(4,3,0)="ÄÄ":B$(4,4,0)="ÄÄ"
1060 A$(2,3,2)="áä":A$(2,4,2)="Öã":A$(1,3,2)="”€":A$(1,4,2)="◊”":A$(3,3,2)="ÉÅ":A$(3,4,2)="ÇÉ":A$(4,3,2)="âÜ":A$(4,4,2)="âÜ"
1070 B$(2,3,2)="Åâ":B$(2,4,2)="ÜÇ":B$(1,3,2)="—Ÿ":B$(1,4,2)="÷“":B$(3,3,2)="Öá":B$(3,4,2)="ãä":B$(4,3,2)="ÄÄ":B$(4,4,2)="ÄÄ"
1099 S(1,1,1)=1:S(1,1,2)=2:A=1:B=1:GOSUB1200
1100 S(2,2,1)=1:S(2,2,2)=3:A=2:B=2:GOSUB1200
1110 S(2,1,1)=1:S(2,1,2)=1:A=2:B=1:GOSUB1200
1120 S(1,2,1)=3:S(1,2,2)=3:A=1:B=2:GOSUB1200
1130 S(0,0,1)=2:S(0,0,2)=4:A=0:B=0:GOSUB1200
1140 S(0,1,1)=2:S(0,1,2)=2:A=0:B=1:GOSUB1200
1150 S(1,0,1)=4:S(1,0,2)=4:A=1:B=0:GOSUB1200
1160 S(0,2,1)=2:S(0,2,2)=3:A=0:B=2:GOSUB1200
1170 S(2,0,1)=1:S(2,0,2)=4:A=2:B=0:GOSUB1200
1190 GOTO1300
1200 FORT=1TO4:S(A,B,2+T)=T:NEXT:RETURN
1300 D(1,1)=-1:D(1,2)=0
1310 D(2,1)=1:D(2,2)=0
1320 D(3,1)=0:D(3,2)=-1
1330 D(4,1)=0:D(4,2)=1
1400 C(1,1)=-1:C(1,2)=31
1410 C(2,1)=2:C(2,2)=34
1420 C(3,1)=-32:C(3,2)=-31
1430 C(4,1)=64:C(4,2)=65
1900 FORT=0TO7:FORZ=0TO15:K(128+(16*T)+Z)=T+1:NEXT:NEXT:K(128)=0
1999 GOTO200
