100 CLEAR2000:DEFINTI:GOSUB3000:'COPYRIGHT 1980 KATHY PFEIFFER MICRO-FANTASTIC PROGRAMMING
110 GOSUB1080:CLEAR:E=64:RANDOM
120 G=15:D=0:A=0:B=131:GOSUB180:D=0:A=960:B=131:GOSUB180
130 GOSUB190:C=0:D=60:GOSUB190
140 H=21:Y=132:GOSUB210:Y=163:GOSUB210:D=0:G=4:C=132:GOSUB190:D=0:C=580:GOSUB190:Y=836:GOSUB210:D=0:C=184:GOSUB190:D=0:C=632:GOSUB190:Y=867:GOSUB210:H=17
150 Y=264:GOSUB210:D=0:G=2:C=264:GOSUB190:D=0:C=584:GOSUB190:Y=712:GOSUB210:Y=291:GOSUB210:D=0:C=308:GOSUB190:D=0:C=628:GOSUB190:Y=739:GOSUB210:H=36:Y=396:GOSUB210:D=0:C=396:G=3:GOSUB190:Y=588:GOSUB210:D=0:C=432:GOSUB190
160 GOSUB1180
170 GOTO220
180 S=USR(RND(10000)):FORX=0TO60:POKE15360+X+A,B:NEXT:RETURN
190 S=USR(RND(10000)):FORX=1TOG:D=D+C:C=E:POKE15360+D,191:NEXT
200 RETURN
210 FORX=0TOH:POKE15360+X+Y,131:NEXT:RETURN
220 S=USR(1):PRINT@463,"                           ";:GOTO240
230 GOSUB1180
240 PRINT@465,"SCORE";:PRINT@475,"TURN ";:PRINT@484,"HIGH SCORE";:PRINT@550,;:B=16278:A=16294:POKEB,143:POKEA,88:C=1:F=4:CC=4:K=143:L=1:L=1:NN=1:RR=5:V=88:R=4:P=1:DI=5000
250 IFTT=4:SS=0:TT=0:GOSUB1050:GOTO260ELSEIFSS>=2000THEN260ELSEIFTT=3:TT=0:SS=0:GOSUB1050
260 S=USR(11111):PRINT@529,;:PRINTUSING"#####";SS;:PRINT@475,"TURN ";:TT=TT+1:PRINT@540,TT;:FORX=1TO500:NEXT
270 IFPEEK(14400)=8GOSUB410:GOTO310
280 IFPEEK(14400)=32GOSUB530:GOTO310
290 IFPEEK(14400)=64GOSUB580:GOTO310
300 IFPEEK(14400)=16GOSUB470:GOTO310
310 IFZ>0THENZA=ZA+1:IFZA>2:Z=0:ZA=0
320 R=4:ONCGOTO330,350,370,390
330 POKEA,32:A=A+F:IFPEEK(A+2)=191:A=A-64:GOSUB1310:C=2:O=0:Z=1ELSEGOSUB1310
340 GOTO610
350 POKEA,32:A=A-128:IFPEEK(A-64)=131GOSUB1310:C=3:O=0:Z=1ELSEGOSUB1310
360 GOTO610
370 POKEA,32:A=A-F:IFPEEK(A-2)=191:A=A+64:GOSUB1310:C=4:Z=1:O=0ELSEGOSUB1310
380 GOTO610
390 POKEA,32:A=A+128:IFPEEK(A+64)=131GOSUB1310:C=1:O=0:Z=1ELSEGOSUB1310
400 GOTO610
410 IFZ>0ORO=1RETURNELSEIFC=3GOTO440ELSEIFC<>1RETURNELSEIFPEEK(A-63)=131RETURN
420 POKEA,32:IFPEEK(A-192)=131ELSEA=A-128:POKEA,88:O=1:S=USR(DI):POKEA,32:FORX=1TO40:NEXT:IFPEEK(A-63)=131RETURNELSEIFPEEK(14400)=8ELSERETURN
430 S=USR(DI):O=1:A=A-128:RETURN
440 IFPEEK(A-65)=131RETURN
450 POKEA,32:IFPEEK(A-192)=131ELSEA=A-128:POKEA,88:O=1:S=USR(DI):POKEA,32:FORX=1TO40:NEXT:IFPEEK(A-65)=131RETURNELSEIFPEEK(14400)=8ELSERETURN
460 S=USR(DI):O=1:A=A-128:RETURN
470 IFZ>0ORO=1RETURNELSEIFC=3GOTO500ELSEIFC<>1RETURNELSEIFPEEK(A+65)=131RETURN
480 POKEA,32:IFPEEK(A+192)=131ELSEA=A+128:POKEA,88:O=1:S=USR(DI):POKEA,32:FORX=1TO40:NEXT:IFPEEK(A+65)=131RETURNELSEIFPEEK(14400)=16ELSERETURN
490 S=USR(DI):O=1:A=A+128:RETURN
500 IFPEEK(A+63)=131RETURN
510 POKEA,32:IFPEEK(A+192)=131ELSEA=A+128:POKEA,88:O=1:S=USR(DI):POKEA,32:FORX=1TO40:NEXT:IFPEEK(A+63)=131RETURNELSEIFPEEK(14400)=16ELSERETURN
520 S=USR(DI):O=1:A=A+128:RETURN
530 IFC=4THEN590ELSEIFC<>2RETURNELSEIFA=15866GOTO540ELSEIFA=15862GOTO550ELSERETURN
540 POKEA,32:A=A-R:POKEA,88:FORX=1TO2:S=USR(DI):NEXT:IFPEEK(14400)=32THEN550ELSERETURN
550 POKEA,32:A=A-R:POKEA,88:S=USR(DI):RETURN
560 POKEA,32:A=A+R:POKEA,88:FORX=1TO2::S=USR(DI):NEXT:IFPEEK(14400)=64THEN570ELSERETURN
570 POKEA,32:A=A+R:POKEA,88:S=USR(DI):RETURN
580 IFC=4THEN600ELSEIFC<>2RETURNELSEIFA=15858GOTO560ELSEIFA=15862GOTO570ELSERETURN
590 IFA=15750ORA=15878GOTO550ELSEIFA=15754ORA=15882GOTO540ELSERETURN
600 IFA=15746ORA=15874GOTO560ELSEIFA=15750ORA=15878GOTO570ELSERETURN
610 IFC=LANDABS(A-B)<25GOTO620ELSEIFA>BGOSUB750ELSEGOSUB800
620 GOSUB830
630 IFM>0THENMA=MA+1:IFMA>3:M=0:MA=0
640 R=4:ONLGOTO650,670,690,710
650 GOSUB1290:B=B-CC:IFPEEK(B-2)=191:B=B-64:GOSUB1300:POKEB,143:L=2:M=1ELSEGOSUB1300:POKEB,143
660 GOSUB730:GOTO270
670 GOSUB1290:B=B-128:IFPEEK(B-64)=131GOSUB1300:POKEB,143:L=3:M=1ELSEGOSUB1300:POKEB,143
680 GOSUB730:GOTO270
690 GOSUB1290:B=B+CC:IFPEEK(B+2)=191:B=B+64:GOSUB1300:POKEB,143:L=4:M=1:ELSEGOSUB1300:POKEB,143
700 GOSUB730:GOTO270
710 GOSUB1290:B=B+128:IFPEEK(B+64)=131GOSUB1300:POKEB,143:L=1:M=1ELSEGOSUB1300:POKEB,143
720 GOSUB730:GOTO270
730 PRINT@529,;:PRINTUSING"#####";SS;:HH=ABS(A-B):IFHH<4GOSUB990:GOTO230
740 IFC=LRETURNELSEIFHH=64GOSUB990:GOTO230ELSERETURN
750 IFNN=0ELSENU=RND(RR):IFNU<5:NN=0:RETURNELSERETURN
760 NN=1:IFM>0RETURNELSEIFL=1GOTO780ELSEIFL<>3RETURNELSEIFPEEK(B+64)=131RETURN
770 POKEB,32:B=B+128:POKEB,143:S=USR(DI):RETURN
780 IFPEEK(B+64)=131RETURNELSE790
790 POKEB,32:B=B+128:POKEB,143:S=USR(DI):RETURN
800 IFN1=0ELSENU=RND(RR):IFNU<5:N1=0:RETURNELSERETURN
810 N1=1:IFM>0RETURNELSEIFL=1THEN820ELSEIFL<>3RETURNELSEIFPEEK(B-64)=131RETURNELSEPOKEB,32:B=B-128:POKEB,143:S=USR(DI):RETURN
820 IFPEEK(B-64)=131RETURNELSEPOKEB,32:B=B-128:POKEB,143:S=USR(DI):RETURN
830 IFL=4THEN860ELSEIFL<>2RETURNELSEIFB=15814GOTO900ELSEIFB=15810ELSEIFB=15818GOTO950ELSERETURN
840 IFRND(2)=1ELSEIFABS(A-B)<257:I=R*2:R=IELSERETURN
850 POKEB,32:B=B+R:POKEB,143:S=USR(DI):RETURN
860 IFB=15798ELSEIFB=15802GOTO930ELSEIFB=15794GOTO970ELSERETURN
870 IFRND(2)=1ELSEIFA-B>359THEN890ELSERETURN
880 POKEB,32:B=B-R:POKEB,143:S=USR(DI):RETURN
890 POKEB,32:B=B+R:POKEB,143:S=USR(DI):RETURN
900 IFRND(2)=1ELSEIFB-A>323THEN920ELSERETURN
910 POKEB,32:B=B+R:POKEB,143:S=USR(DI):RETURN
920 POKEB,32:B=B-R:POKEB,143:S=USR(DI):RETURN
930 IFRND(2)=1ELSEIFABS(A-B)<257:I=R*2:R=I
940 POKEB,32:B=B-R:POKEB,143:S=USR(DI):RETURN
950 IFA<15451ORA=15490ORB-A=72:I=R*2:R=I:GOTO960ELSEIFB-A<196RETURN
960 POKEB,32:B=B-R:POKEB,143:S=USR(DI):RETURN
970 IFA>16290ORA=16250ORA-B=72:I=R*2:R=IELSEIFA-B>323THEN980ELSERETURN
980 POKEB,32:B=B+R:POKEB,143:S=USR(DI):RETURN
990 FORX=1TO3:S=USR(RND(15000)+5000):POKEA,143:S=USR(RND(15000)+5000):POKEB,42:S=USR(6180)
1000 FORI=1TO10:POKEA,32:POKEB,32:NEXTI:NEXTX
1010 IFSX=71:SS=SS+1000:BN=1000:GOTO1040
1020 SX=0:IFHS>SSRETURN
1030 HS=SS:RETURN
1040 FORX=1TO600:NEXT:FORJ=1TO5:PRINT@475,"BONUS";:PRINT@538,BN;:FORX=1150TO1155:S=USR(X):NEXT:PRINT@538,"     ";:S=USR(16150):NEXT:PRINT@529,;:PRINTUSING"#####";SS;:GOTO1020
1050 PRINT@475,"GAME ";:PRINT@539,"OVER";:FORX=1TO10:S=USR(12000):NEXT:PRINT@550,;:PRINTUSING"#####";HS;:FORX=1TO300:NEXT:PRINT@539,"    ";
1060 S=USR(100):PRINT@475,"PRESS";:PRINT@539,"  S";
1070 A$=INKEY$:IFA$="S"THENRETURNELSE1070
1080 CLS:PRINT@393,".":PRINT@417,".":PRINT@439,".":PRINT@455,"M "CHR$(143)" C R O - F A N T A S T "CHR$(143)" C   P R O G R A M M "CHR$(143)" N G":S=USR(0):FORX=1TO75:NEXT:S=USR(300)
1090 GOSUB1160:CLS:S=USR(RND(15000)):PRINT@473,"P R E S E N T S":FORX=1TO300:NEXT:CLS:GOSUB1170:PRINT@465,"T U N N E L S   O F   F A H A D";:FORX=6150TO6160:S=USR(X):NEXT:GOSUB1160:CLS
1100 CLS:S=USR(RND(5000)):PRINT@414,".":PRINT@468,"C O P Y R "CHR$(143)" G H T    "CHR$(143)" 9 8 0":FORX=1TO300:NEXT:S=USR(RND(5000)):CLS:PRINT@422,".":PRINT@469,"B Y   K .  P F E "CHR$(143)" F F E R":FORX=1TO500:NEXT
1110 CLS:PRINT"THE OBJECT OF THE TUNNELS OF FAHAD IS TO AVOID THE RAMPAGING    MUMMY AND COLLECT AS MUCH SILVER AND TANNER LEAVES AS POSSIBLE.":PRINT@149,CHR$(143)" = MUMMY     X = YOU"
1115 PRINT:PRINT"USE THE KEYS AS FOLLOWS:":PRINT"[ = UP",,"PRESS KEY AND HOLD";
1120 PRINT" TO MOVE":PRINTCHR$(92)" = DOWN ",,"OVER TWO TUNNELS. PRESS AND":PRINTCHR$(93)" = LEFT",,"RELEASE QUICKLY TO MOVE OVER":PRINTCHR$(94)" = RIGHT",,"ONE TUNNEL ."
1125 PRINT:PRINT"SCORING":PRINT"*******":PRINT".  = SILVER         10 POINTS       71 SILVER PIECES ON ONE";
1130 PRINT" TURN ":PRINT@868,"GETS 1000 BONUS PTS. A SCORE";:PRINT"+  = TANNER LEAVES  20 POINTS       OVER 2000 GETS AN EXTRA TURN";
1140 S=USR(9100):PRINT@982,"* PRESS ENTER *";
1150 A$=INKEY$:IFA$=""THEN1150ELSECLS:PRINT@463,"T U N N E L S   O F   F A H A D";:RETURN
1160 FORJ=1TO1000:NEXT:RETURN
1170 FORX=330TO376:PRINT@X,CHR$(143):NEXT:FORX=663TO683:PRINT@X,CHR$(143):NEXT:RETURN
1180 FORJ=1TO3
1190 FORX=1TO13:POKE15360+70+ZZ+ZY,46:ZZ=ZZ+4:NEXT
1200 ZZ=0:ZY=ZY+128:NEXTJ
1210 FORJ=1TO3
1220 FORX=1TO13:POKE15552+70+ZZ+ZY,46:ZZ=ZZ+4:NEXT
1230 ZZ=0:ZY=ZY+128:NEXTJ
1240 FORX=1TO7:POKE15490+W,46:POKE15482+W,46:W=W+128:NEXT
1250 FORX=1TO3
1260 FORJ=1TO3:POKE15450+YY+YZ,32:POKE16026+YY+YZ,32:YY=YY+4:NEXTJ
1270 YY=0:YZ=YZ+128:NEXTX:POKE15426,32:POKE15686,32:POKE15622,46:POKE15690,32:POKE15909,32:POKE15558,32:POKE16050,32:POKE16054,32:POKE16182,32:POKE16118,46:POKE15990,46:POKE15986,46:POKE16314,32:W=0:ZY=0:YZ=0
1280 RETURN
1290 IFP=1THENP=0:POKEB,46:RETURNELSEIFSX>50ANDL=1ORSX>60ANDL=3THEN1320ELSEPOKEB,32:RETURN
1300 IFPEEK(B)=46THENP=1:RETURNELSERETURN
1310 IFPEEK(A)=46THENSS=SS+10:SX=SX+1:POKEA,88:S=USR(500):RETURNELSEIFPEEK(A)=43THENSS=SS+20:POKEA,88:S=USR(500):RETURNELSEPOKEA,88:RETURN
1320 EE=EE+1:IFRND(3)+3>EETHENPOKEB,43:S=USR(1100):RETURNELSEPOKEB,32:EE=0:RETURN
1330 M1=27151
1340 I=VARPTR(M1):J=PEEK(I+1)+256*PEEK(I+2)
1350 FORK=JTOJ+26:READX:POKEK,X:NEXT
1360 IFPEEK(16396)=201POKE16526,PEEK(I+1):POKE16527,PEEK(I+2)ELSECMD"T":DEFUSR0=PEEK(I+1)+256*PEEK(I+2):POKE14308,0
1370 RETURN
1380 DATA205,127,10,77,68,62,1,105,211,255,45,32,253,60,105,211,255,45,32,253,13,16,238,175,211,255,201
3000 M$="Í
MD>iÓÿ- ý<iÓÿ- ý
î¯ÓÿÉ"
3010 I=VARPTR(M$):I=ABS(I):J=PEEK(I+1)+256*PEEK(I+2)
3015 IF J>32767 THEN J=J-65535
3020 FORK=JTOJ+26:READX:POKEK,X:NEXT
3030 IFPEEK(16396)=201POKE16526,PEEK(I+1):POKE16527,PEEK(I+2)ELSECMD"T":DEFUSR0=PEEK(I+1)+256*PEEK(I+2):POKE14308,0
3040 RETURN
3050 DATA205,127,10,77,68,62,1,105,
 211,255,45,32,253,60,105,
 211,255,45,32,253,13,16,
 238,175,211,255,201

