 100 ' Copyright (C) 1983 NEC Corp.
110 ' Tank Game "TANK.BA"
120 CLEAR 300,59917!:GOSUB 1160
130 DEFINT C-Z
140 DIM D(31,9),HX(3),HY(3)
150 AH=10000
160 LE=3
170 INPUT"INPUT LEVEL (1-4)";LE
180 IF LE>4 OR LE<1 THEN 170
190 RESTORE 1150:FOR I=0 TO 3:READ HX(I),HY(I):NEXT
200 GOSUB 1340
210 AA=0:MAN=5:ME=0
220 X=30:Y=4:S=1
230 GOSUB 920 : T=1
240 A$=INKEY$:IF A$>CHR$(32) OR A$<CHR$(28) THEN 410
250 LOCATE X-1,Y-1:PRINT" ";
260 IF A$=CHR$(30) THEN H=0
270 IF A$=CHR$(28) THEN H=1
280 IF A$=CHR$(31) THEN H=2
290 IF A$=CHR$(29) THEN H=3
300 X=X+HX(H):Y=Y+HY(H)
310 D=D(X,Y):IF D=0 THEN 400
320 IF A$=" " THEN IF D=1 THEN D(X,Y)=0:SOUND 500,1:LOCATE X-1,Y-1:PRINT" ";:X=X-HX(H):Y=Y-HY(H):GOTO 400
330 IF D>1 THEN X=X-HX(H):Y=Y-HY(H):GOTO 400
340 X1=X+HX(H):Y1=Y+HY(H)
350 DD=D(X1,Y1)
360 IF DD<>0 THEN X=X-HX(H):Y=Y-HY(H):GOTO 400
370 D(X,Y)=0:D(X1,Y1)=1
380 SOUND 200,1
390 LOCATE X1-1,Y1-1:PRINTCHR$(131);
400 LOCATE X-1,Y-1:PRINTCHR$(133+H);
410 SOUND 4000,1
420 LOCATE S-1,T-1:PRINT" ";:D(S,T)=0
430 IF K>0 THEN K=K-1:IF D(S+HX(G),T+HY(G))=0 THEN 500
440 K=RND(1)*5+2
450 NN=0
460 G=RND(1)*4
470 IF D(S+HX(G),T+HY(G))=0 THEN 500
480 G=(G+1) MOD 4:NN=NN+1:IF NN=4 THEN 720
490 GOTO 470
500 S=S+HX(G):T=T+HY(G)
510 LOCATE S-1,T-1:PRINTCHR$(132);
520 D(S,T)=3
530 IF X=S AND T=Y THEN 570
540 TI=TI-1:IF TI<0 THEN 570
550 LOCATE 35,2:PRINTUSING"####";TI
560 GOTO 240
570 FOR I=4000 TO 800 STEP -50
580 SOUND I,1
590 LOCATE X-1,Y-1:PRINT"@";
600 LOCATE X-1,Y-1:PRINT"*";
610 NEXT
620 MAN=MAN-1
630 LOCATE 37,0:PRINTMAN
640 IF MAN>0 THEN 220
650 IF AA>AH THEN AH=AA
660 FOR I=0 TO 7:LOCATE 0,I:PRINT" ";:NEXT
670 GOSUB 1070
680 LOCATE 10,2:A$="GAME OVER":GOSUB1740
690 LOCATE 5,5:A$="REPLAY PRESS "+CHR$(34)+"s"+CHR$(34)+" KEY":GOSUB1740
700 A$=INKEY$:IF A$<>"s" AND A$<>"S" AND A$<>"Ä" THEN 700
710 GOTO 210
720 IF TI<101 THEN 780
730 SOUND 8000,10
740 TI=TI-100:AA=AA+LE*100
750 LOCATE 33,5:PRINTUSING"######";AA
760 LOCATE 35,2:PRINTUSING"####";TI
770 GOTO 720
780 IF TI<11 THEN 840
790 SOUND 4000,5
800 TI=TI-10:AA=AA+LE*10
810 LOCATE 33,5:PRINTUSING"######";AA
820 LOCATE 35,2:PRINTUSING"####";TI
830 GOTO 780
840 IF TI=0 THEN 900
850 SOUND 2000,1
860 TI=TI-1:AA=AA+LE
870 LOCATE 33,5:PRINTUSING"######";AA
880 LOCATE 35,2:PRINTUSING"####";TI
890 GOTO 840
900 ME=ME+1:IF ME=10 THEN ME=7
910 GOTO 220
920 SCREEN ,0:CLS
930 FOR I=1 TO 30
940 FOR J=1 TO 8
950 D(I,J)=0
960 NEXT
970 NEXT
980 FOR I=0 TO 31:D(I,0)=2:D(I,9)=2:NEXT
990 FOR J=1 TO 8:D(0,J)=2:D(31,J)=2:NEXT
1000 TI=1000-ME*100
1010 FOR T=1 TO (5-LE)*10
1020 I=RND(1)*28+2:J=RND(1)*6+2
1030 LOCATE I-1,J-1:PRINTCHR$(131);
1040 D(I,J)=1:SOUND 300,1
1050 NEXT
1060 LOCATE X-1,Y-1:PRINTCHR$(133);
1070 LOCATE 31,0:PRINT"MEN"
1080 LOCATE 31,2:PRINT"TIME"
1090 LOCATE 31,4:PRINT"SCORE"
1100 LOCATE 31,6:PRINT"HIGH-SC";
1110 LOCATE 33,7:PRINTUSING"**####";AH;
1120 LOCATE 37,0:PRINTMAN
1130 LOCATE 33,5:PRINTUSING"######";AA
1140 RETURN
1150 DATA 0,-1,1,0,0,1,-1,0
1160 '
1170 POKE 65215!,14
1180 POKE 65216!,234
1190 AD=59918!
1200 RESTORE 1270
1210 FOR I=0 TO 5
1220 FOR J=0 TO 5
1230 READ D:POKE AD+I*6+J,D
1240 NEXT
1250 NEXT
1260 RETURN
1270 DATA 224,240,252,254,240,192
1280 DATA 16,8,48,64,56,4
1290 DATA 7,200,62,62,200,7
1300 DATA 128,67,63,203,8,12
1310 DATA 56,139,127,127,139,56
1320 DATA 12,8,203,63,67,128
1330 DATA 97,119,29,80,100,104,114
1340 SCREEN ,0:CLS
1350 LOCATE 10,0:PRINT" SNAKE "
1360 LOCATE 1,2:A$="To trap the SNAKE with the rock piles":GOSUB 1740
1370 LOCATE 0,4:A$="while avoid being bitten by the SNAKE!!":GOSUB 1740
1380 LOCATE 9,6:A$=" PUSH ANY KEY":GOSUB 1740
1390 A$=INPUT$(1)
1400 CLS
1410 LOCATE 5,2:PRINT"  "
1420 LOCATE 5,2:PRINT"  "
1430 LOCATE 5,3:PRINT" "
1440 LOCATE 5,4:PRINT"  "
1450 LOCATE 5,5:PRINT" "
1460 LOCATE 5,6:PRINT"   "
1470 K=1:T=3:S=12:X=30:Y=4
1480 FOR X=38 TO 30 STEP -1
1490 LOCATE X,Y:PRINT" ";
1500 SOUND 6000,5
1510 LOCATE S,T:PRINT" ";:T=T+K:K=-K
1520 LOCATE S,T:PRINT"";
1530 NEXT
1540 FOR X=28 TO 13 STEP -1
1550 LOCATE X,Y:PRINT" ";
1560 LOCATE S,T:PRINT" ";:T=T+K:K=-K
1570 LOCATE S,T:PRINT"";:SOUND 3000,3
1580 NEXT
1590 FOR X=11 TO 6 STEP -1
1600 LOCATE X,Y:PRINT" ";
1610 SOUND 9000,3
1620 NEXT
1630 S=6
1640 FOR I=1 TO 10
1650 SOUND 3000,1:LOCATE S,T:PRINT"";
1660 SOUND 5000,1:LOCATE S,T:PRINT"";
1670 NEXT
1680 FOR I=1 TO 1000:NEXT:CLS:PRINT"@@@@@@@@@@@@ KEY OPERATION @@@@@@@@@@@@@"
1690 A$="(MAN) [<] Left [>] Right":LOCATE 5,2:GOSUB 1740:LOCATE 12,3:A$="[^] Up [v] Down":GOSUB 1740
1700 A$="To remove  ..... SPACE KEY":LOCATE 5,5:GOSUB 1740
1710 A$="PUSH ANY KEY TO START":LOCATE 12,7:GOSUB1740
1720 A$=INPUT$(1)
1730 RETURN
1740 FOR I=1 TO LEN(A$)
1750 PRINTMID$(A$,I,1);
1760 SOUND I*400,1
1770 NEXT
1780 FOR I=1 TO 500:NEXT
1790 RETURN
