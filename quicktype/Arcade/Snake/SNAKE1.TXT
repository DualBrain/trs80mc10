100 CLS
110 REM SNAKE GAME
120 CLEAR 300
130 DIM X,Y,X1,Y1,S,T,H,OH,D,K,G,DD
140 DIM D(31,9),HX(5),HY(5),K(255):K(87)=1:K(83)=2:K(90)=3:K(65)=4:K(32)=5
150 AH=10000
160 LE=3
170 INPUT"INPUT LEVEL (1-4)";LE
180 IF LE>4 OR LE<1 THEN 170
190 RESTORE:FOR I=1 TO 4:READ HX(I),HY(I):NEXT
200 GOSUB 1340
210 AA=0:MAN=5:ME=0
220 X=30:Y=4:S=1
230 GOSUB 920:T=1
240 H=K(PEEK(2)ANDPEEK(17023)):ONH GOTO250,250,250,250,245:GOTO410
245 ON1-(D(X+HX(OH),Y+HY(OH))=1)GOTO260:D(X+HX(OH),Y+HY(OH))=0:SOUND5,1:H=OH:PRINT@X+HX(H)+32*(Y+HY(H)-1)," ";:GOTO400
250 OH=H
260 PRINT@X+32*(Y-1)," ";:X=X+HX(H):Y=Y+HY(H):D=D(X,Y):OND+1GOTO400
330 ONDGOTO340:X=X-HX(H):Y=Y-HY(H):GOTO400
340 X1=X+HX(H):Y1=Y+HY(H):DD=D(X1,Y1):ONDDGOTO350,350:GOTO370
350 X=X-HX(H):Y=Y-HY(H):GOTO400
370 D(X,Y)=0:D(X1,Y1)=1:SOUND2,1:PRINT@X1+32*(Y1-1),CHR$(191);
400 PRINT@X+32*(Y-1),"X";
410 SOUND40,1:PRINT@S+32*(T-1)," ";:D(S,T)=0:ON1-(K>0)GOTO440:K=K-1:IF D(S+HX(G),T+HY(G))=0 THEN 500
440 K=INT(RND(0)*5)+2:NN=0:G=RND(4)
470 OND(S+HX(G),T+HY(G))+1GOTO500:G=(G-4*INT(G/4))+1:NN=NN+1:ONNNGOTO470,470,470,720
500 S=S+HX(G):T=T+HY(G)
510 PRINT@S+32*(T-1),"S";
520 D(S,T)=3
530 IF X=S AND T=Y THEN 570
540 TI=TI-1:IF TI<0 THEN 570
550 PRINT@16+32*10,TI
560 GOTO240
570 FORI=40TO8STEP-5
580 SOUNDI,1
590 PRINT@X+32*(Y-1),"@";
600 PRINT@X+32*(Y-1),"*";
610 NEXT
620 MAN=MAN-1
630 PRINT@16+32*9,MAN
640 IF MAN>0 THEN 220
650 IF AA>AH THEN AH=AA
660 FOR I=0 TO 7:PRINT@0+32*I," ";:NEXT
670 GOSUB 1070
680 PRINT@32*14,"GAME OVER"
690 PRINT@32*15,"REPLAY PRESS "+CHR$(34)+"s"+CHR$(34)+" KEY";
700 A$=INKEY$:IF A$<>"s" AND A$<>"S" AND A$<>"Ã„" THEN 700
710 GOTO 210
720 IF TI<101 THEN 780
730 SOUND80,10
740 TI=TI-100:AA=AA+LE*100
750 PRINT@16+32*11,AA
760 PRINT@16+32*10,TI
770 GOTO720
780 IF TI<11 THEN 840
790 SOUND40,5
800 TI=TI-10:AA=AA+LE*10
810 PRINT@16+32*11,AA
820 PRINT@16+32*10,TI
830 GOTO 780
840 IF TI=0 THEN 900
850 SOUND20,1
860 TI=TI-1:AA=AA+LE
870 PRINT@32*11+16,AA
880 PRINT@32*10+16,TI
890 GOTO 840
900 ME=ME+1:IF ME=10 THEN ME=7
910 GOTO 220
920 CLS
930 FOR I=1 TO 30
940 FOR J=1 TO 8
950 D(I,J)=0
960 NEXT
970 NEXT
980 FOR I=0 TO 31:D(I,0)=2:D(I,9)=2:NEXT
990 FOR J=1 TO 8:D(0,J)=2:D(31,J)=2:NEXT
1000 TI=1000-ME*100
1010 FOR T=1 TO (5-LE)*10
1020 I=INT(RND(0)*28)+2:J=INT(RND(0)*6)+2
1030 PRINT@I+32*(J-1),CHR$(191);
1040 D(I,J)=1:SOUND3,1
1050 NEXT
1055 FORT=0TO31:PRINT@T+32*8,CHR$(128);:NEXT:FORT=0TO8:PRINT@31+32*T,CHR$(128);:PRINT@32*T,CHR$(128);:NEXT
1060 PRINT@X+32*(Y-1),"X";
1070 PRINT@9*32,"MEN";
1080 PRINT@10*32,"TIME";
1090 PRINT@11*32,"SCORE";
1100 PRINT@12*32,"HIGH-SC";
1110 PRINT@16+32*12,AH;
1120 PRINT@16+32*9,MAN
1130 PRINT@16+32*11,AA
1140 RETURN
1150 DATA 0,-1,1,0,0,1,-1,0
1340 CLS
1350 PRINT"  -==========SNAKE===========-"
1355 PRINT:PRINT"GAME OBJECT:":PRINT
1360 PRINT"TO TRAP THE SNAKE WITH THE"
1361 PRINT"ROCK PILES WHILE AVOIDING"
1362 PRINT"BEING BITTEN BY THE SNAKE!!"
1410 PRINT@32*11+25,"¿";
1420 PRINT@32*9+5, " ¿     ¿";
1430 PRINT@32*10+5,"¿¿¿¿¿¿¿ ¿¿";
1440 PRINT@32*11+5,"¿";
1450 PRINT@32*12+5,"¿¿¿¿¿¿¿ ¿¿";
1460 PRINT@32*13+5," ¿     ¿ ";
1470 K=1:T=3:S=12+(32*7):X=26:Y=11
1480 FOR X=30 TO 26 STEP -1
1490 PRINT@X+32*Y,"X ";
1500 SOUND60,5
1510 PRINT@S+32*T," ";:T=T+K:K=-K
1520 PRINT@S+32*T,"S";
1530 NEXT
1540 FOR X=24 TO 13 STEP -1
1550 PRINT@X+32*Y,"¿X ";
1560 PRINT@S+32*T," ";:T=T+K:K=-K
1570 PRINT@S+32*T,"S";:SOUND30,3
1580 NEXT
1590 FOR X=11 TO 6 STEP -1
1600 PRINT@X+32*Y,"S¿X ";
1610 SOUND90,3
1620 NEXT
1630 S=6+(32*7)
1640 FOR I=1 TO 10
1650 SOUND30,1:PRINT@S+32*T,"S";
1660 SOUND50,1:PRINT@S+32*T," ";
1670 NEXT:GOSUB1710
1680 CLS:PRINT" -=======KEY OPERATION========-"
1690 PRINT"X(MAN) < LEFT > RIGHT":PRINT@7+32*3,"^  UP  V DOWN"
1700 PRINT"TO REMOVE ¿ ... SPACE KEY":PRINT@5+32*5,"";
1710 PRINT@480,"PRESS ANY KEY TO CONTINUE";:PRINT@12+32*7,"";
1720 A$=INKEY$:ON1-(A$<>"")GOTO1720
1730 RETURN
