0 DIMK(255),P(100),X,Y,A,B,Q,R,T,C,P,V,Q(511):GOTO2000
1 V=-1:RETURN
2 V=-32:RETURN
3 V=1:RETURN
4 V=32:RETURN
5 RETURN
6 T=T+1:P(T)=P:POKEP,191:RETURN
7 FORC=1TOT:POKEP(C),223:NEXT:T=0:V=0:RETURN
8 V=0:RETURN
10 X=A:Y=B:IFPOINT(X,Y-1)THENQ=(RND(0)*.75+.25)*-SGN(Q)
11 IFPOINT(X,Y+1)THENQ=(RND(0)*.75+.25)*-SGN(Q)
12 IFPOINT(X-1,Y)THENR=(RND(0)*.75+.25)*-SGN(R)
13 IFPOINT(X+1,Y)THENR=(RND(0)*.75+.25)*-SGN(R)
20 FORA=1TO5000:A=X:B=Y:RESET(X,Y):X=X+R:Y=Y+Q:ONPOINT(X,Y)GOTO10,10,10,200,200,10,10,10:SET(X,Y,1)
21 XT=X:YT=Y:RESET(X,Y):X=X+R:Y=Y+Q:ONPOINT(X,Y)GOTO10,10,10,200,200,10,10,10:SET(X,Y,1)
22 ONK(ASC(INKEY$+"*"))GOSUB1,2,3,4,50:ONK(PEEK(P+V))GOSUB6,7,8:P=P+V:POKEP,207:NEXT
30 PRINT@480,"HIT c TO CONTINUE";
32 I$=INKEY$:IFI$<>"C"THEN32
34 GOTO2010
50 Q=0:N=0:X=INT(X/2):Y=INT(Y/2):PRINT@32*Y+X,CHR$(128);
51 Q=Q+1:Q(Q)=32*Y+X+16384
52 IFN=QTHENSC=SC+(315-Q):PRINT@0,"SCORE"SC;:A=5000:RETURN
53 N=N+1:B=PEEK(Q(N)):IFB=128ORB=239THENGOSUB60
55 GOTO52
60 POKEQ(N),175:IFPEEK(Q(N)-1)=128THENQ=Q+1:Q(Q)=Q(N)-1:POKEQ(Q),239
62 IFPEEK(Q(N)+1)=128THENQ=Q+1:Q(Q)=Q(N)+1:POKEQ(Q),239
63 IFPEEK(Q(N)-32)=128THENQ=Q+1:Q(Q)=Q(N)-32:POKEQ(Q),239
64 IFPEEK(Q(N)+32)=128THENQ=Q+1:Q(Q)=Q(N)+32:POKEQ(Q),239
65 RETURN
200 PRINT@0,"YOU'RE DEAD!";:PRINT@480,"PLAY AGAIN (Y/N)?";
210 I$=INKEY$:IFI$=""THEN210
220 IFI$="Y"THEN2005
230 IFI$="N"THENEND
240 GOTO210 
2000 K(65)=1:K(87)=2:K(83)=3:K(90)=4:K(32)=5:K(128)=1:K(223)=2:K(191)=3
2005 SC=0:IFHS>SCTHENHS=SC
2010 CLS0:FORX=0TO63:SET(X,0,6):SET(X,1,6):SET(X,31,6):SET(X,30,6):NEXT
2020 FORY=0TO31:SET(0,Y,6):SET(1,Y,6):SET(63,Y,6):SET(62,Y,6):NEXT
2030 X=13+RND(20):Y=13+RND(10):R=1:Q=1:P=16384+33:POKEP,207:V=0:T=0:GOTO20
