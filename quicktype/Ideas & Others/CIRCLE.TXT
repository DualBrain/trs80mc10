0 CLEAR100:DIMLU(1,2):FORX=0TO1:FORY=0TO2:READLU(X,Y):NEXTY,X:DATA32,8,2,16,4,1
1 VIDRAM=16384:VND=16895:VCTRL=49151:CH=16:GOTO20
2 POKEBYTE,MASK:IFMASK<192THENPOKEBYTE,MASK+64
3 POKEVCTRL,CHOR(PEEK(VCTRL)AND7):RETURN
4 POKEVCTRL,0:RETURN
5 X1=INT(X/2):Y1=INT(Y/3):BYTE=VIDRAM+(X1+Y1*32):VLU=LU(INT(X-X1*2),INT(Y-Y1*3))
6 MASK=VLUORPEEK(BYTE):ONPSTGOTO7,2:POKEBYTE,NOT(NOTMASKORVLU):RETURN
7 POKEBYTE,MASK:RETURN
8 FORZZ=0TO1:X(ZZ)=X(ZZ)/4:Y(ZZ)=Y(ZZ)/4:NEXTZZ:DX=X(1)-X(0):DY=Y(1)-Y(0):SX=SGN(DX):SY=SGN(DY):IFDX=0THEN10
9 SL=DY/DX:B=Y(0)-SL*X(0):T1=SQR(SL*SL+1):NX=1/T1*SX:FORXT=X(0)TOX(1)STEPNX:X=INT(XT+.5):Y=INT(SL*XT+B+.5):GOSUB5:NEXTXT:RETURN
10 X=X(0):FORY=Y(0)TOY(1)STEPSY:GOSUB5:NEXTY:RETURN
20 GOSUB4:CLS
30 INPUT "ENTER X,Y,R";CX,CY,R
40 INPUT "COLOUR (1=BLUE 2=RED)";PST:IFPST<1ORPST>2THENPST=1
50 CLS0:GOSUB3
60 XC=0:YC=R:PC=3-2*R 
70 GOSUB200
80 IFPC<0THENPC=PC+4*XC+6:GOTO100
90 PC=PC+4*(XC-YC)+10:YC=YC-1   
100 XC=XC+1 
110 IFXC<YCTHEN70
120 IFXC=YCTHENGOSUB 200 
125 IF PST=0THEN20
130 I$=INKEY$:IFI$=""THEN130
140 PST=0:GOTO60
200 X=CX+XC:Y=CY+YC:GOSUB5
210 X=CX-XC:Y=CY+YC:GOSUB5
220 X=CX+XC:Y=CY-YC:GOSUB5 
230 X=CX-XC:Y=CY-YC:GOSUB5
240 X=CX+YC:Y=CY+XC:GOSUB5 
250 X=CX-YC:Y=CY+XC:GOSUB5 
260 X=CX+YC:Y=CY-XC:GOSUB5 
270 X=CX-YC:Y=CY-XC:GOSUB5 
280 RETURN
