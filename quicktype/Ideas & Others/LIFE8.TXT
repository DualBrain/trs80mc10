100 CLS:PRINT"PLEASE WAIT..."
110 DIMA(1000,1),X,Y,XL,XP,YL,YP,P8,NO,HX,LX,HY,LY,CN,N,C,WN,ZE,MX,MY,N1,T2,T3,GN,PA
120 GOTO500
130 CN=CN+1:SET(X,Y,WN):A(CN,0)=X:A(CN,1)=Y
132 XL=X-WN:IFXL=N1THENXL=HX
134 XP=X+WN:IFXP=MXTHENXP=ZE
136 YL=Y-WN:IFYL=N1THENYL=HY
138 YP=Y+WN:IFYP=MYTHENYP=ZE
140 CN=CN+1:A(CN,0)=XL:A(CN,1)=YL
142 CN=CN+1:A(CN,0)=X:A(CN,1)=YL
144 CN=CN+1:A(CN,0)=XP:A(CN,1)=YL
146 CN=CN+1:A(CN,0)=XL:A(CN,1)=Y
148 CN=CN+1:A(CN,0)=XP:A(CN,1)=Y
150 CN=CN+1:A(CN,0)=XL:A(CN,1)=YP
152 CN=CN+1:A(CN,0)=X:A(CN,1)=YP
154 CN=CN+1:A(CN,0)=XP:A(CN,1)=YP
156 RETURN
160 CLS0
180 PRINT@448,"";
190 INPUT"X,Y:";X,Y
200 IFX<0ORY<0THEN230
205 GOSUB130
210 PRINT@452,"           ";
220 GOTO180
230 PRINT@448,"";:FORNO=1TO32:PRINTCHR$(128);:NEXTNO
240 FORN=WNTOCN:X=A(N,ZE):Y=A(N,WN)
250 XL=X-WN:IFXL=N1THENXL=HX
260 XP=X+WN:IFXP=MXTHENXP=ZE
270 YL=Y-WN:IFYL=N1THENYL=HY
280 YP=Y+WN:IFYP=MYTHENYP=ZE
310 NO=POINT(XL,YL)+POINT(X,YL)+POINT(XP,YL)+POINT(XL,Y)+POINT(XP,Y)+POINT(XL,YP)+POINT(X,YP)+POINT(XP,YP)
390 IFPOINT(X,Y)THENIFNO=T2ORNO=T3THEN410
400 IFNO=T3THEN410
405 IFN=CNTHENCN=CN-WN:GOTO420
406 FORC=NTOCN-WN:A(C,ZE)=A(C+WN,ZE):A(C,WN)=A(C+WN,WN):NEXTC:N=N-1:CN=CN-1
410 NEXTN
420 CLS0:PRINT@480,"GEN:";GN;:GN=GN+1
430 FORN=WNTOCN:X=A(N,ZE):Y=A(N,WN)
440 SET(X,Y,WN):NEXTN
445 CN=ZE:FORX=ZETOHX:FORY=ZETOHY
446 IFPOINT(X,Y)THENGOSUB130
450 NEXTY,X
460 GOTO240
500 HX=63:LX=0:HY=29:LY=0:WN=1:N1=-1:ZE=0:MX=64:MY=30
510 T2=2:T3=3:GN=1:PA=496
530 CLS:PRINTTAB(6);"JOHN CONWAY'S LIFE":PRINT:PRINT"RUN THE R PENTOMINO (Y/N)?"
540 I$=INKEY$:IFI$=""THEN540
550 IFI$="Y"THENCLS0:FORNO=1TO5:READX,Y:GOSUB130:NEXTNO:GOTO240
560 IFI$<>"N"THEN540
565 PRINT:PRINT"RUN THE GLIDER (Y/N)?"
570 I$=INKEY$:IFI$=""THEN570
575 IFI$="Y"THENCLS0:FORNO=1TO5:READX,Y:NEXTNO:FORNO=1TO5:READX,Y:GOSUB130:NEXTNO:GOTO240
580 IFI$="N"THEN130
585 GOTO570
590 DATA31,10,32,10,31,11,30,11,31,12,32,25,33,26,33,27,32,27,31,27
