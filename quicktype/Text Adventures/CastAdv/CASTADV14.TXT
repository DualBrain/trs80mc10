0 CLS:CLEAR380:DIMC,B,V,H,U,V(1),C(7,174),V$(59,1),I$(65),I(69),R$(42),N$(1):GOTO2100
1 C=1:B=32
2 IFMID$(M$,B,1)<>""ANDMID$(M$,B,1)<>" "THENB=B-1:GOTO2
3 PRINTMID$(M$,C,B-C):C=B+1:B=C+31:IFC<=LEN(M$)THEN2
4 RETURN
5 NEXTY
6 IFV(0)<>0THEN8
7 NEXTX
8 IFV(0)=0THENRETURN
9 IFV(0)<>8ANDV(0)<>16ANDO=0THENGOSUB375
10 IFITHENRETURN
11 IFV(0)<>8ANDV(0)<>16ANDNOTITHENPRINT"NOTHING HAPPENED":RETURN
12 IFV(0)=8ORV(0)=16THENGOSUB1790
13 IFF=0THENRETURN
14 IFNOTITHENPRINT"YOU CAN'T DO THAT YET."
15 RETURN
16 I=IANDG:IFITHENNEXTY:GOTO1080
17 GOTO7
18 G=I(66)ANDINT(2^Q+.5):RETURN
20 RESTORE:FORC=0TOB:READM$:NEXTC:RETURN
40 H=171:U=0:FORC=0TO171:V=INT(C(0,C)/150):IFV=BTHEN51
41 NEXTC:IFH=171ANDU=0THENU=171
42 RETURN
51 IFC>UTHENU=C
52 IFC<HTHENH=C
55 GOTO41
60 E=E+1:ONEGOTO62,62,62,62,62:W=C(1,X):GOTO64
62 W=C(E,X)
64 P=INT(W/20):M=W-P*20:IFM<>0THEN60
66 RETURN
70 PRINT"YOU DO NOT HAVE IT!":RETURN
72 PRINT"I DON'T SEE IT HERE.":RETURN
74 NEXTX:ONKGOTO70,72:IFK=0ANDV(1)=0THENPRINT"YOU CAN'T":F=0
75 IFK=0ANDV(1)<>0THENF=1
76 IFK<>0THENF=0
77 RETURN
80 I$=I$(Z):IFRIGHT$(I$,1)<>"/"THENRETURN
81 FORW=LEN(I$)-1TO1STEP-1:IFMID$(I$,W,1)="/"THENI$=LEFT$(I$,W-1):RETURN
82 NEXTW:RETURN
300 R=1:I(67)=100:I(68)=0:I(66)=0:INPUT"USE SAVED GAME";K$:IFK$<>"Y"THEN370
340 CLOAD*I,"CASTDATA":R=I(69)
370 GOSUB550:GOTO440
375 PRINT"WHAT?":RETURN
380 PRINT:INPUT">";I$:PRINTCHR$(8)"<":GOSUB450:IFFTHENGOSUB375:GOTO380
400 GOSUB710:IFI(9)<>-1THEN440
420 I(67)=I(67)-1:IFI(67)<0THENPRINT"LIGHT HAS RUN OUT!":I(9)=0:GOTO440
430 IFI(67)<25THENPRINT"LIGHT RUNS OUT IN "I(67)" TURNS!"
440 V(0)=0:GOSUB710:GOTO380
450 K=0:N$(0)="":N$(1)="":A=0:FORX=1TOLEN(I$):K$=MID$(I$,X,1):IFK$=" "THENK=1:GOTO480
475 N$(K)=LEFT$(N$(K)+K$,3)
480 NEXTX:FORX=0TO1:V(X)=0:IFN$(X)=""THEN540
490 FORY=0TO55:K$=V$(Y,X):IFLEFT$(K$,1)="*"THENK$=MID$(K$,2)
500 IFX=1ANDY<7THENK$=LEFT$(K$,3)
510 IFN$(X)=K$THENV(X)=Y:GOTO530
520 NEXTY:GOTO540
530 IFLEFT$(V$(V(X),X),1)="*"THENV(X)=V(X)-1:GOTO530
540 NEXTX:IF(V(0)=8ORV(0)=16)ANDV(1)<1THENA=1:GOTO1950
545 F=V(0)<1ORLEN(N$(1))>0ANDV(1)<1:RETURN
550 IFI(68)THENIFI(9)<>-1ANDI(9)<>RTHENPRINT"IT IS TOO DARK TO SEE!":RETURN
560 K=-1:B=73+R:GOSUB20:IFLEFT$(M$,1)="*"THENM$="YOU "+MID$(M$,2):GOTO580
570 M$="YOU ARE IN "+M$
580 GOSUB1:FORZ=0TO65:IFKTHENIFI(Z)=RTHENPRINT"VISIBLE ITEMS:":K=0
640 IFI(Z)<>RTHEN670
650 GOSUB80:M$=I$:GOSUB1
670 NEXT:K=-1:M$="OBVIOUS EXITS: ":FORZ=0TO5:RM=VAL(MID$(R$(R),(Z*2)+1,2)):IFRM<>0THENK=0:M$=M$+V$(Z+1,1)+" "
700 NEXT:IFKTHENRETURN
705 GOSUB1:RETURN
710 I=-1:F=-1:IFV(0)=1ANDV(1)<7THEN1190
711 B=V(0):GOSUB40:IFV(0)<>0THEN750
722 V=RND(100):FORX=HTOU:IFV<=C(0,X)THEN800
740 NEXTX:RETURN
750 IFA=1THENGOSUB1810:RETURN
755 N=V(1)+150*V(0):V=150*V(0):O=0
757 IFV(0)=8ORV(0)=16THENI=0
760 FORX=HTOU:IFN=C(0,X)ORV=C(0,X)THEN800
770 GOTO7
800 O=1:I=-1:F=0:FORY=1TO5:ONYGOTO810,810,810,810,810:W=C(1,X):GOTO860
810 W=C(Y,X)
860 Q=INT(W/20):K=W-Q*20:G=-1
870 ONK+1GOTO16,940,960,980,1000,1010,1020,1030,1040,1050,900,920,950,970,990
900 G=-1:FORZ=0TO65:IFI(Z)=-1THEN16
910 NEXT:G=0:GOTO16
920 G=0:FORZ=0TO65:IFI(Z)=-1THEN16
930 NEXT:G=-1:GOTO16
940 G=I(Q)=-1:GOTO16
950 G=I(Q)<>-1ANDI(Q)<>R:GOTO16
960 G=I(Q)=R:GOTO16
970 G=I(Q)<>0:GOTO16
980 G=I(Q)=RORI(Q)=-1:GOTO16
990 G=I(Q)=0:GOTO16
1000 G=R=Q:GOTO16
1010 G=I(Q)<>R:GOTO16
1020 G=I(Q)<>-1:GOTO16
1030 G=R<>Q:GOTO16
1040 GOSUB18:G=G<>0:GOTO16
1050 GOSUB18:G=G=0:GOTO16
1080 E=0:FORY=1TO4:K=INT((Y-1)/2+6):ONYGOTO1090,1100,1110,1120
1090 J=INT(C(6,X)/150):GOTO1130
1100 J=C(6,X)-INT(C(6,X)/150)*150:GOTO1130
1110 J=INT(C(7,X)/150):GOTO1130
1120 J=C(7,X)-INT(C(7,X)/150)*150
1130 IFJ>101THEN1180
1140 IFJ=0THEN5
1150 IFJ<52THENB=J:GOSUB20:GOSUB1:GOTO5
1160 ONJ-51GOTO1290,1330,1340,1360,1370,1380,1390,1360,1410,1430,1440,1450,1470,1480,1530,1570,1580,1590,5,2020,1350
1180 B=J-50:GOSUB20:GOSUB1:GOTO5
1190 L=I(68):IFLTHENL=I(68)ANDI(9)<>RANDI(9)<>-1:GOTO1210
1200 GOTO1220
1210 IFLTHENPRINT"IT'S DARK!"
1220 IFV(1)<1THENPRINT"WHICH DIRECTION?":RETURN
1230 K=VAL(MID$(R$(R),((V(1)-1)*2)+1,2))
1240 IFK>=1THEN1270
1250 IFLTHENPRINT"YOU FELL AND BROKE YOUR NECK":K=42:I(68)=0:GOTO1270
1260 PRINT"YOU CAN'T GO THAT WAY!":RETURN
1270 R=K:GOSUB550:RETURN
1290 L=0:FORZ=1TO65:IFI(Z)=-1THENL=L+1
1300 NEXTZ
1310 IFL>=5THENPRINT"YOU'VE TOO MUCH ALREADY!":GOTO6
1320 GOSUB60:I(P)=-1:GOTO5
1330 GOSUB60:I(P)=R:GOTO5
1340 GOSUB60:R=P:GOTO5
1350 GOSUB60:L=P:GOSUB60:Z=I(P):I(P)=I(L):I(L)=Z:GOTO5
1360 GOSUB60:I(P)=0:GOTO5
1370 I(68)=-1:GOTO5
1380 I(68)=0:GOTO5
1390 GOSUB60
1400 I(66)=INT(.5+2^P)ORI(66):GOTO5
1410 GOSUB60
1420 I(66)=I(66)ANDNOTINT(.5+2^P):GOTO5
1430 PRINT"YOU'RE DEAD":R=42:I(68)=0:GOTO1470
1440 GOSUB60:L=P:GOSUB60:I(L)=P:GOTO5
1450 END
1470 GOSUB550:GOTO5
1480 L=0:FORZ=1TO65:IFI(Z)=12THENIFLEFT$(I$(Z),1)="*"THENL=L+1
1490 NEXTZ:PRINT"YOU'VE STORED"L"TREASURES":PRINT"SCORE="INT(L/11*100)"%"
1510 IFL=11THENPRINT"WELL DONE.":END
1520 GOTO5
1530 M$="YOU HAVE: ":K$="NOTHING, ":FORZ=0TO65:IFI(Z)<>-1THEN1560
1540 GOSUB80:M$=M$+I$+", ":K$=""
1560 NEXT:I$=M$+K$:M$=LEFT$(I$,LEN(I$)-2):GOSUB1:GOTO5
1570 P=0:GOTO1400
1580 P=0:GOTO1420
1590 I(67)=100:I(9)=-1:GOTO5
1790 IFV(0)=0THEN2010
1800 IFV(1)=0THENGOSUB375:GOTO1950
1810 IFV(0)<>8THEN1840
1820 L=0:FORZ=0TO65:IFI(Z)=-1THENL=L+1
1830 NEXT:IFL>=5THENPRINT"YOU'VE TOO MUCH ALREADY!":GOTO1950
1840 K=0:FORX=0TO65:IFRIGHT$(I$(X),1)<>"/"THEN74
1850 Q=LEN(I$(X))-3:I$=MID$(I$(X),Q,3):IFI$<>N$(1)THEN74
1890 IFV(0)=8THEN1920
1900 IFI(X)<>-1THENK=1:GOTO74
1910 I(X)=R:K=3:GOTO1940
1920 IFI(X)<>RTHENK=2:GOTO74
1930 I(X)=-1:K=3
1940 PRINT"OK"
1950 F=0:RETURN
2020 I(69)=R:CSAVE*I,"CASTDATA":GOTO5
2100 X=RND(-(PEEK(9)*256+PEEK(10))):PRINT"load CASTADV2":CLOAD*C,"CASTADV2":B=115:GOSUB20
2160 FORX=0TO59:READV$(X,0),V$(X,1):NEXT:FORX=1TO42:READR$(X):NEXT:FORX=0TO65:READI$(X),I(X):NEXT:GOTO300
2470 DATA"",THERE'S A STRANGE SOUND,NOTHING HAPPENS,IT'S LOCKED,IT'S OPEN,THERE'S SOMETHING THERE-MAYBE YOU SHOULD
2500 DATATHAT'S NOT VERY SAFE,YOU MAY NEED MAGIC HERE,SORRY...YOU CAN'T,YOU DON'T HAVE IT,IT'S EMPTY,YOU HAVE NO CONTAINER
2530 DATAWHAT A WASTE...,OPEN IT?,GO THERE?,OK,YOU FOUND SOMETHING!,YOU DIDN'T FIND ANYTHING,YOU DON'T SEE IT HERE
2560 DATAUSE ONE WORD,OH...THAT FEELS GOOD!,USE QUIT,A VOICE BOOMS OUT...,LEAVE IT ALONE!,DON'T BE SILLY!
2590 DATATHE GUARD WON'T LET YOU!,THE BARON SUCKS EGGS!,READ SCOTT FOR MAGIC WORD,IVANHOE!
2610 DATATHE HOOK CATCHES AND THE ROPE HANGS DOWN,YOU HAVE TO THROW IT FIRST!,THE MATCHES ARE TOO WET,IT'S BLAZING
2640 DATAAN ANGRY-LOOKING GUARD APPEARS,IT'S TOO HIGH AND STEEP,SOMETHING FELL OUT,TRY THE PIANO,BE ADVENTEROUS!
2660 DATAYOU MADE A TASTY MEAL!,YOU NEED SOME EXERCISE,CRASH...IT'S DOWN!,READING IMPROVES THE MIND
2670 DATATHE GUARD THROWS YOU OVER THE EDGE,WITH A BROKEN ARM,YOUR ARM HAS HEALED
2700 DATATHE GUARD MISTAKES YOU FOR THE BARON AND LEAVES,YOU DON'T HAVE THE NECESSARY RESOURCES
2710 DATATIME HEALS ALL THINGS,TRY ANOTHER BOOK,IT WAS A FIERCE FIGHT,BUT YOU LOST,BUT YOU FINALLY WON,IT DISAPPEARS
2720 DATAINTO THE CHASM,LEAVE PEACEFULLY!,THROW SOMETHING,SORRY ABOUT THAT,THE SKULL SPEAKS-,BEWARE THE VAMPIRE
2730 DATABEWARE THE CHEST,BEWARE THE GOLD BARS,YOU JUST LOST YOUR CURSOR AND THE GAME IS OVER
2800 DATALEAVE THE GUARD IN HIS QUARTERS, THE BAT JUST BIT YOU,THE DOOR SLAMS SHUT!,YOU HEAR THE FLAP OF WINGS
2830 DATATHE TOAD SAYS 'RIB-BIT',YOU SEE A POISONOUS SPIDER CRAWLING TOWARD YOU,YOU WERE JUST BITTEN BY A POISONOUS SPIDER
2860 DATATHE BARON SUDDENLY APPEARS WITH A LARGE SWORD AND IT'S OFF WITH YOUR HEAD!,IT MISSED!,READ IT?,YOU HAVE NO WATER
2870 DATATHE BOTTLE SHATTERS!,A THICK WOODS,A DARK FOREST,*ARE ON A BRANCH NEAR THE TOP OF A TREE
2950 DATA*ARE BY THE WATER'S EDGE OF THE MOAT,A CLEARING NEXT TO A HILL,*ARE BY THE ENTRANCE TO A CAVE
2980 DATAA LARGE CAVERN WITH TUNNELS GOING OFF IN ALL DIRECTIONS,A SMALL CAVERN WITH MANY OPENINGS LEADING FROM IT
3100 DATAA LOW PASSAGE-WAY,A LARGE CAVERN WITH SHEER WALLS,A SMALL ROOM CARVED INTO THE CAVE WALL
3130 DATA*ARE ON THE TOP HILL. THE CASTLE IS SOUTH,THE WATER-IT'S ICY COLD
3160 DATA*ARE BY THE OUTER CASTLE WALLS,*ARE ON A CATWALK NEAR THE WEST TOWER,A SMALL CHAMBER IN THE WEST TOWER
3190 DATATHE GUARDS' QUARTERS,THE WEST END OF A GREAT HALL,THE CASTLE COURTYARD,THE EAST END OF THE GREAT HALL
3230 DATATHE KITCHEN,A SECRET PASSAGE BEHIND THE FIREPLACE,THE CASTLE'S STABLES,THE BARON'S PRIVATE CHAMBERS
3270 DATAA LONG TUNNEL SLOPING DOWNWARD,THE TURRET ROOM OF THE EAST TOWER,THE BARON'S FAMILY CRYPT
3300 DATAA CAVERN WITH GLOWING WALLS,AN ODD-SHAPED ROOM WITH A STRANGE SMELL
3320 DATA*ARE ON A LEDGE ON THE NORTH SIDE OF A WIDE CHASM,THE EAST END OF A LARGE CAVERN
3350 DATA*AT A CROSSROADS IN A LONG TUNNEL,*ARE IN HELL,THE WEST END OF A LARGE CAVERN
3380 DATATHE BARON'S SECRET STRONGHOLD,*ARE ON A LEDGE ON THE SOUTH SIDE OF A WIDE CHASM
3410 DATATHE BARON'S TREASURY,A TWISTING TUNNEL IN THE DUNGEON,A LONG PASSAGE WITH ROWS OF CELLS
3440 DATAA SECRET PASSAGE,A DUNGEON CELL,*MAY PICK AN EXIT THAT MIGHT RETURN YOU TO LIFE
3890 DATAAUT,ANY,GO,NORTH,*ENT,SOUTH,*RUN,EAST,*WAL,WEST,*CLI,UP,*CRA,DOWN,JUM,GAM,GET,TOR,*TAK,*ON
3910 DATA*PIC,OFF,*CAT,DOO,LIG,SCO,*TUR,KEY,*TOR,HEL,*BUR,INV,DRO,SIG,*REL,ARO,*SPI,FIR,*LEA,KNA
3930 DATA*GIV,TRE,THR,HIL,QUI,CAV,LOO,WAT,*SHO,ROP,*SEE,GUA,SCO,PAS,INV,OPE,SAV,PIL,OPE,WAL
3950 DATAATT,BOO,*KIL,AXE,*FIG,PIA,FIN,*MUS,LOC,GRA,HEL,DRA,SAY,HOR,STO,ARM,UNL,FOO,EAT,WIN
3970 DATADRI,PRI,BRE,LAD,*SMA,CHE,SWI,COF,PLA,*STA,CUT,TOA,*CHO,SKU,REA,BAT,RID,BAR,*MOU,COB
3990 DATADIS,*WEB,IVA,LED,KIS,,*LOV,,*FUC,"",FIR,,,,,,,,,,010401020000,020401050000,000000000001,010000000000
4000 DATA000002000000,000005000000,000706080700,080807080908,080808100908,000009000000,000000000000,020100000005
4010 DATA041400000000,130000000000,000018001600,000000170015,000016000000,000020150019,230000001800,210000182400
4020 DATA002000190000,180000000025,001900000000,000000002620,000000002227,000000000024,000000002500,000029002700
4030 DATA003000280000,290000000000,321100340000,333100000035,000000000000,350031000000,003436003200,000000350000
4040 DATA000000000000,383900003839,383900003839,000037240000,000000000000,330333333312
4900 DATATREES,1,TREES,2,UNLIT TORCH/TOR/,6,ROPE WITH GRAPPLING HOOK ON END/ROP/,9,CAVE IN THE SIDE OF THE HILL,5
4920 DATASIGN SAYING 'NO SWIMMING',4,MATCHES/MAT/,0,SOGGY MATCHES/MAT/,18,KNAPSACK/KNA/,-1,BLAZING TORCH/TOR/,0
4930 DATATHE CASTLE ACROSS THE WATER,4,THE DRAWBRIDGE IS UP,4,A HEAVY OAK DOOR,11,AN ANGRY-LOOKING GUARD,11
4950 DATAA BROKEN ARM,0,THE DRAWBRIDGE IS DOWN,0,A SCHOOL OF MAN-EATING PIRANHA,13,SIGN 'LEAVE TREASURE HERE-SAY SCORE',12
4980 DATAOPENING HIGH UP NEAR THE TOP OF THE CAVERN,10,*MAGIC SLEEPING PILLS/PIL/,12
5000 DATAA SCHOOL OF SLEEPY PIRANHA,0,A GRAND PIANO,20,A BOOKCASE FILLED WITH CLASSICS,24
5010 DATAA SECRET PASSAGE BEHIND THE BOOKCASE,0,FOOD/FOO/,21,WINE/WIN/,21,A BATTLE AXE/AXE/,17,GRAFFITI ON THE WALLS,23
5030 DATAA THICK ROPE HOLDING THE DRAWBRIDGE UP,19,*SILVER SUIT OF ARMOR/ARM/,24,A BOOK OF HORROR STORIES/BOO/,0
5040 DATA*RARE 1ST EDITION OF SCOTT/BOO/,0,SOME PIANO KEYS/KEY/,0,A ROPE HANGING DOWN,0,A FIREPLACE,18
5060 DATAA FIREPLACE WITH A BLAZING FIRE,0,AN OPEN DOOR,0,*A LARGE DIAMOND/DIA/,0,*THE BARON'S BEST HORSE/HOR/,23
5070 DATAMUDDY WATER,4,*JEWELED URN/URN/,27,COFFIN,27,AN OPEN COFFIN WITH STAIRS INSIDE,0,ONES/BON/,27,SKULL/SKU/,27
5090 DATABA VAMPIRE BAT,0,*BAG OF RUBIES/RUB/,29,SIGN 'DANGER-GO BACK',32,*TREASURE CHEST/CHE/,35,A LONG LADDER/LAD/
5110 DATA36,*GOLD BARS/BAR/,37,*SILVER CROSS/CRO/,37,GUARD'S KEYS/KEY/,0,AN OPEN DOORWAY,37,A LOCKED STEEL DOOR,0
5120 DATAA LOCKED OAK DOOR,41,ANOTHER LEDGE ON THE NORTH SIDE,36,A NARROW LEDGE ON THE OTHER SIDE,30,AN UNCONSCIOUS GUARD,0
5140 DATAA HORNY TOAD/TOA/,41,*BEAUTIFUL PRINCESS/PRI/,0,AN OPEN DOORWAY,0,THE CASTLE TO THE SOUTH
5160 DATA3,COBWEBS,27,COBWEBS,35,COBWEBS,38
