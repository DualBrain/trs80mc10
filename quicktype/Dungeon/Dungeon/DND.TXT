0 DIM D(31,14),X,Y
5 CLS0
10 FORX=0TO31:D(X,0)=191:D(X,14)=191:NEXT
20 FORY=0TO14:D(0,Y)=191:D(31,Y)=191:NEXT
30 FORY=0TO14:FORX=0TO31:PRINT@X+(32*Y),CHR$(D(X,Y));:NEXT:NEXT
40 GOSUB1000:GOTO900
50 PRINT@X+(32*Y),CHR$(D(X,Y));
51 PRINT@X-1+(32*Y),CHR$(D(X-1,Y));
52 PRINT@X-1+(32*(Y-1)),CHR$(D(X-1,Y-1));
53 PRINT@X+(32*(Y-1)),CHR$(D(X,Y-1));
54 PRINT@X+1+(32*(Y-1)),CHR$(D(X+1,Y-1));
55 PRINT@X+1+(32*Y),CHR$(D(X+1,Y));
56 PRINT@X+1+(32*(Y+1)),CHR$(D(X+1,Y+1));
57 PRINT@X+(32*(Y+1)),CHR$(D(X,Y+1));
58 PRINT@X-1+(32*(Y+1)),CHR$(D(X-1,Y+1));
60 RETURN
200 IF D(X-1,Y)=0THEN D(X-1,Y)=32:IFRND(2)=1THEN D(X-1,Y)=223:IFRND(10)=1THEN D(X-1,Y)=100
210 IF D(X+1,Y)=0THEN D(X+1,Y)=32:IFRND(2)=1THEN D(X+1,Y)=223:IFRND(10)=1THEN D(X+1,Y)=100
220 IF D(X,Y-1)=0THEN D(X,Y-1)=32:IFRND(2)=1THEN D(X,Y-1)=223:IFRND(10)=1THEN D(X,Y-1)=100
230 IF D(X,Y+1)=0THEN D(X,Y+1)=32:IFRND(2)=1THEN D(X,Y+1)=223:IFRND(10)=1THEN D(X,Y+1)=100
240 RETURN
250 IF D(X-1,Y)=223THEN D(X-1,Y)=191:IFRND(10)=1THEN D(X-1,Y)=32
260 IF D(X+1,Y)=223THEN D(X+1,Y)=191:IFRND(10)=1THEN D(X+1,Y)=32
270 IF D(X,Y-1)=223THEN D(X,Y-1)=191:IFRND(10)=1THEN D(X,Y-1)=32
280 IF D(X,Y+1)=223THEN D(X,Y+1)=191:IFRND(10)=1THEN D(X,Y+1)=32
285 RETURN
900 X=15:Y=13
905 D(X,Y)=80:GOSUB200:GOSUB50
910 I$=INKEY$:IFI$=""THEN910

920 IFI$="W"THEN IF D(X,Y-1)=32THEN D(X,Y)=32:Y=Y-1:GOTO950
930 IFI$="Z"THEN IF D(X,Y+1)=32THEN D(X,Y)=32:Y=Y+1:GOTO950
935 IFI$="S"THEN IF D(X+1,Y)=32THEN D(X,Y)=32:X=X+1:GOTO950
940 IFI$="A"THEN IF D(X-1,Y)=32THEN D(X,Y)=32:X=X-1:GOTO950
945 IFI$="T"THENGOSUB250
950 IFI$="M"THENCLS0:GOTO30
990 GOTO905
1000 PRINT@480,"SECREt TRaP MIsSILE MAGIC mENU ";:POKE16895,96
1010 RETURN
1100 PRINT@480,"sMASH pICK LiSTEN OR qUIT      ";:POKE16895,96
1110 RETURN

1100 PRINT"X=TRAP D=DOOR P=PARTY M=MONSTER"
1120 PRINT
