
100 'EXECUTE A MAZE GAME
110 '
120 'READ MAZE FILE
130 INPUT"MAZE FILE NAME:";MF$
140 OPEN "I",#1,MF$
150 INPUT#1,H,W,DP
160 DIM R(H,W,DP)
170 FOR Z=1 TO H:FOR X=1 TO W:FOR Y=1 TO DP
180 INPUT#1,R(Z,X,Y)
190 NEXT:NEXT:NEXT
200 INPUT#1,B$
210 '
220 'INITIALIZE
230 SCREEN 1,0
240 PMODE 4
250 COLOR 2,3
260 PCLS
270 Y=INT(DP/2)
280 X=INT(W/2)
290 Z=INT(H/2)
300 D=0
310 C$="20154130540235431254"
320 '
330 'MAIN LOOP - DO UNTIL OUT
340 PCLS
350 LINE(0,0)-(255,191),PSET,B
360 C=R(Z,X,Y)
370 GOSUB 710
380 M=INT(2^VAL(MID$(C$,(D*5)+1,1)))
390 IF (C AND M ) <> 0 THEN GOSUB 790
400 M=INT(2^VAL(MID$(C$,(D*5)+2,1)))
410 IF (C AND M ) <> 0 THEN GOSUB 870
420 M=INT(2^VAL(MID$(C$,(D*5)+3,1)))
430 IF (C AND M ) <> 0 THEN GOSUB 950
440 M=INT(2^VAL(MID$(C$,(D*5)+4,1)))
450 IF (C AND M ) <> 0 THEN GOSUB 1110
460 M=INT(2^VAL(MID$(C$,(D*5)+5,1)))
470 IF (C AND M ) <> 0 THEN GOSUB 1030
480 A$=INKEY$: IF A$="" THEN GOTO 480
490 A=INSTR("UDBLSRH",A$)
500 IF A=0 THEN GOTO 480
510 IF A$<>"H" THEN GOTO 580
520 SCREEN 0,0
530 PRINT "THE SEQUENCE IS:"; B$
540 PRINT "PRESS ANY KEY TO CONTINUE"
550 A$=INKEY$: IF A$="" THEN GOTO 550
560 SCREEN 1,0
570 GOTO 480
580 A=INT(2^(VAL(MID$("543210542103541032540321",(D*6)+A,1))))
590 IF (C AND A ) = 0 THEN GOTO 480
600 IF A$="U" THEN Z=Z-1 ELSE IF A$="D" THEN Z=Z+1
610 IF A$="R" THEN D=D+1: IF D=4 THEN D=0
620 IF A$="B" THEN D=D+2: IF D>3 THEN D=D-4
630 IF A$="L" THEN D=D-1: IF D=-1 THEN D=3
640 IF (A$="U") OR (A$="D") THEN GOTO 660
650 IF D=0 THEN Y=Y-1 ELSE IF D=1 THEN X=X+1 ELSE IF D=2 THEN Y=Y+1 ELSE X=X-1
660 IF NOT((X=0) OR (X=W+1) OR (Y=0) OR (Y=DP+1) OR (Z=0) OR (Z=H+1)) THEN GOTO 690
670 PRINT "YOU'RE OUT! HIT ANY KEY TO PLAY ANOTHER"
680 A$=INKEY$: IF A$="" THEN GOTO 680 ELSE GOTO 230
690 GOTO 340
700 '
710 'DRAW ROOM OUTLINE
720 LINE (80,60)-(176,132),PSET,B
730 LINE (0,0)-(80,60),PSET
740 LINE (0,191)-(80,132),PSET
750 LINE (255,0)-(176,60),PSET
760 LINE (255,191)-(176,132),PSET
770 RETURN
780 '
790 'DRAW LEFT DOOR
800 LINE (26,172)-(26,70),PSET
810 LINE (52,152)-(52,78),PSET
820 LINE (26,70)-(52,78),PSET
830 CIRCLE (34,121),3
840 PAINT (34,121),0
850 RETURN
860 '
870 'DRAW RIGHT DOOR
880 LINE (203,152)-(203,78),PSET
890 LINE (229,172)-(229,70),PSET
900 LINE (203,78)-(229,70),PSET
910 CIRCLE (222,121),3
920 PAINT (222,121),0
930 RETURN
940 '
950 'DRAW DOOR STRAIGHT AHEAD
960 LINE (112,132)-(112,84),PSET
970 LINE (144,132)-(144,84),PSET
980 LINE (112,84)-(144,84),PSET
990 CIRCLE (138,110),3
1000 PAINT (138,110),0
1010 RETURN
1020 '
1030 'DRAW LOWER OPENING
1040 LINE(100,172)-(156,172),PSET
1050 LINE (109,152)-(147,152),PSET
1060 LINE (100,172)-(109,152),PSET
1070 LINE (156,172)-(147,152),PSET
1080 PAINT(128,162),0
1090 RETURN
1100 '
1110 'DRAW UPPER OPENING
1120 LINE(100,24)-(156,24),PSET
1130 LINE(109,44)-(147,44),PSET
1140 LINE(100,24)-(109,44),PSET
1150 LINE(147,44)-(156,24),PSET
1160 PAINT (128,34),0
1170 RETURN
