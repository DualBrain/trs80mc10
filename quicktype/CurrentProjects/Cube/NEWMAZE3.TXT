0 CLS:GOSUB1500:CLEAR200:DIMZ,US,X,Y,X0,Y0,X1,Y1,R(5,5,5)
2 GOSUB2000:GOTO100
3 POKEVC,4:RETURN
4 POKEVC,0:RETURN
5 US=USR((X0*256+Y0)*65537):RETURN:REM FOR SINGLE POINT
6 US=USR((X0*256+Y0)*65536+X1*256+Y1):RETURN:REM TO DRAW LINE
100 REM EXECUTE A MAZE GAME
110 REM 
120 REM READ MAZE FILE
130 INPUT"MAZE FILE NAME:";MF$:CLOAD*R,MF$
150 H=5:W=5:DP=5
220 REM INITIALIZE
230 GOSUB3
260 CLS0
270 Y=INT(DP/2)
280 X=INT(W/2)
290 Z=INT(H/2)
300 D=0
310 C$="20154130540235431254"
320 REM 
330 REM MAIN LOOP - DO UNTIL OUT
340 CLS0
350 X0=0:Y0=0:X1=0:Y1=47:GOSUB6:X0=0:Y0=47:X1=63:Y1=47:GOSUB6:X0=63:Y0=47:X1=63:Y1=0:GOSUB6:X0=63:Y0=0:X1=0:Y1=0:GOSUB6
360 C=R(Z,X,Y)
370 GOSUB 710
380 M=INT(2^VAL(MID$(C$,(D*5)+1,1)))
390 IF (C AND M)<>0 THEN GOSUB 790
400 M=INT(2^VAL(MID$(C$,(D*5)+2,1)))
410 IF (C AND M)<>0 THEN GOSUB 870
420 M=INT(2^VAL(MID$(C$,(D*5)+3,1)))
430 IF (C AND M)<>0 THEN GOSUB 950
440 M=INT(2^VAL(MID$(C$,(D*5)+4,1)))
450 IF (C AND M)<>0 THEN GOSUB 1110
460 M=INT(2^VAL(MID$(C$,(D*5)+5,1)))
470 IF(C AND M)<>0 THEN GOSUB 1030
480 A=0:A$=INKEY$:IFA$=""THEN480
490 IFA$="U"THENA=1:GOTO580
491 IFA$="D"THENA=2:GOTO580
492 IFA$="B"THENA=3:GOTO580
493 IFA$="L"THENA=4:GOTO580
494 IFA$="S"THENA=5:GOTO580
495 IFA$="R"THENA=6:GOTO580
496 IFA$="H"THEN520
500 GOTO480
510 IFA$<>"H"THEN580
520 GOSUB4:CLS:GOSUB1600:PRINT"H THIS MENU":PRINT
540 PRINT "PRESS ANY KEY TO CONTINUE"
550 A$=INKEY$:IFA$=""THEN550
555 IFA$="Q"THENEND
560 GOSUB3:GOTO340
580 A=INT(2^(VAL(MID$("543210542103541032540321",(D*6)+A,1))))
590 IF(C AND A)=0THEN480
600 IFA$="U"THENZ=Z-1
601 IFA$="D"THENZ=Z+1
610 IFA$="R"THEND=D+1:IF D=4 THEN D=0
620 IFA$="B"THEND=D+2:IF D>3 THEN D=D-4
630 IFA$="L"THEND=D-1:IF D=-1 THEN D=3
640 IF(A$="U")OR(A$="D")THEN660
650 IFD=0THENY=Y-1:GOTO660
651 IFD=1THENX=X+1:GOTO660
652 IFD=2THENY=Y+1:GOTO660
653 X=X-1
660 IF NOT((X=0) OR (X=W+1) OR (Y=0) OR (Y=DP+1) OR (Z=0) OR (Z=H+1))THEN340
670 GOSUB4:CLS:PRINT"YOU'RE OUT! HIT ANY KEY TO PLAY ANOTHER"
680 A$=INKEY$:IFA$=""THEN680
681 GOTO230
700 REM
710 REM DRAW ROOM OUTLINE
720 X0=20:Y0=15:X1=20:Y1=33:GOSUB6:X0=20:Y0=33:X1=44:Y1=33:GOSUB6:X0=44:Y0=33:X1=44:Y1=15:GOSUB6:X0=44:Y0=15:X1=20:Y1=15:GOSUB6
730 X0=0:Y0=0:X1=20:Y1=15:GOSUB6
740 X0=0:Y0=47:X1=20:Y1=33:GOSUB6
750 X0=63:Y0=0:X1=44:Y1=15:GOSUB6
760 X0=63:Y0=47:X1=44:Y1=33:GOSUB6
770 RETURN
780 REM 
790 REM DRAW LEFT DOOR
800 X0=6:Y0=43:X1=6:Y1=17:GOSUB6
810 X0=13:Y0=38:X1=13:Y1=19:GOSUB6
820 X0=6:Y0=17:X1=13:Y1=19:GOSUB6
830 X0=8:Y0=30:GOSUB5:RETURN
860 REM 
870 REM DRAW RIGHT DOOR
880 X0=50:Y0=38:X1=50:Y1=19:GOSUB6
890 X0=57:Y0=43:X1=57:Y1=17:GOSUB6
900 X0=50:Y0=19:X1=57:Y1=17:GOSUB6
910 X0=55:Y0=30:GOSUB5:RETURN
940 REM 
950 REM DRAW DOOR STRAIGHT AHEAD
960 X0=28:Y0=33:X1=28:Y1=21:GOSUB6
970 X0=36:Y0=33:X1=36:Y1=21:GOSUB6
980 X0=28:Y0=21:X1=36:Y1=21:GOSUB6
990 X0=34:Y0=27:GOSUB5:RETURN
1020 REM 
1030 REM DRAW LOWER OPENING
1040 X0=25:Y0=43:X1=39:Y1=43:GOSUB6
1050 X0=27:Y0=38:X1=36:Y1=38:GOSUB6
1060 X0=25:Y0=43:X1=27:Y1=38:GOSUB6
1070 X0=39:Y0=43:X1=36:Y1=38:GOSUB6:RETURN
1100 REM 
1110 REM DRAW UPPER OPENING
1120 X0=25:Y0=6:X1=39:Y1=6:GOSUB6
1130 X0=27:Y0=11:X1=36:Y1=11:GOSUB6
1140 X0=25:Y0=6:X1=27:Y1=11:GOSUB6
1150 X0=36:Y0=11:X1=39:Y1=6:GOSUB6:RETURN
1500 PRINT"     AN A'MAZING' ADVENTURE":PRINT"     BY WILLIAM BARDEN, JR."
1510 PRINT"IT'S LIKE THIS: YOU HAVE BEEN"
1520 PRINT"KIDNAPPED. YOU AWAKE TO FIND"
1530 PRINT"YOURSELF IN THE MIDDLE OF A"
1540 PRINT"3-DIMENSIONAL BOX. YOU MUST"
1560 PRINT"NEGOTIATE THE VARIOUS ROOMS"
1570 PRINT"AND FLOORS TO ESCAPE..."
1600 PRINT"S DOOR STRAIGHT AHEAD":PRINT"B DOOR BEHIND YOU":PRINT"L DOOR ON YOUR LEFT":PRINT"R DOOR ON YOUR RIGHT"
1610 PRINT"U OPENING TO FLOOR ABOVE":PRINT"D OPENING TO FLOOR BELOW":RETURN
2000 VI=16384:VC=49151:W=2:E=3:J=0
2020 REM LINE DRAW SUBROUTINE BY GREG DIONNE
2030 REM US=USR((X0*256+Y0)*65537) FOR SINGLE POINT
2040 REM US=USR((X0*256+Y0)*65536+X1*256+Y1) TO DRAW LINE
3000 DATALNPDALMMABABNNLLNMMMJAMKCCAJCFADHPAALLHAAALLEANAMLCCAJCFADHPAALMHAAALMFANNNGBBCDHCEPJHMOJHNLJGNGJHNMINDCJG
3001 DATAMKJBMMCHCIJLLLJHMKJGMOJLNHJHMOBGJANLCKABEANANMCKABFABBCFOANGNMNHNLNLNGNHNMNGMLNLLMNHMLCANAFPHOOMOCNMMKNNNI
3002 DATAJGNJMGKLDNIGIAMAFFEEEEMLFFMBFFCEPIHEAANICEABEEIKIAJHNKIGCADNNLNIIJAAIKEAIEEBNNNINONINGNKOKAAOHAADJEPJHMOJH
3003 DATANLJGNHJHNMINMAJGMLJBMNCHLGJLLMJHMLJGMOJLNGJHMOBGJANLCKABEANANMCKABFABBCFOANGNMNHNLNLNHNHNMNGMKNLLLNHMKCANA
3004 Z=32768:FORX=0TO3:READA$:GOSUB3005:NEXTX:Z=16917:A$="HOIAAA"
3005 FORY=1TOLEN(A$)/2:POKEZ,(ASC(MID$(A$,2*Y-1,1))-65)*16+ASC(MID$(A$,2*Y,1))-65:Z=Z+1:NEXTY:RETURN
3010 END
