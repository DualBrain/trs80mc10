REM ASTEROID BELT....... program made to actually work 4/85 MDS
1 REM      ASTEROID BELT
2 REM
3 REM     BY COREY OSTMAN
4 REM 21101 SO. HARVARD BLVD.
5 REM   TORRANCE, CA  90501
6 REM
7 REM
9 POKE133,231:POKE134,31
10 LE=8:AM=3:ME=LE:D(1)=111:D(2)=226:FORT=1TO6:READB(T):NEXTT
11 GOSUB800:POKE57089,0:POKE56832,3
12 POKE530,1:K=57088:POKEK,128
15 DATA-63,63,-65,65,-64,64
20 FORT=1TOLE
21 A(T)=INT(1408*RND(1)+53696)
22 S(T)=B(6*RND(1)+1)
23 C(T)=D(2*RND(1)+1)
24 POKEA(T),C(T)
30 NEXTT
70 FOR X=1 TO LE
75 IF A(X)=546THEN120
80 POKE A(X),32
90 A(X)=A(X)+S(X)
100 IF A(X)<53696 OR A(X)>55104 THEN 140
105 IFPEEK(A(X))>235THEN500
110 POKE A(X),C(X)
120 POKEK,128:P=PEEK(K):GOTO230
130 NEXTX:GOTO70
140 IFA(X)<53696THENA(X)=A(X)+1408:GOTO150
145 A(X)=A(X)-1408
150 GOTO110
230 IFP=128THENA=-64:GOTO280
240 IFP=64THENA=64:GOTO280
250 IFP=32THENA=-1:GOTO280
260 IFP=16THENA=1:GOTO280
270 IFP=8THEN400
280 POKEY,32
290 IFY+A<53696 THEN Y=Y+1408
295 IFY+A>55104 THEN Y=Y-1408
300 Y=Y+A
305 IFPEEK(Y)<>32THEN500
310 IFA=1THENPOKEY,237:CH=237:GOTO130
320 IFA=-1THENPOKEY,239:CH=239:GOTO130
330 IFA=64THENPOKEY,238:CH=238:GOTO130
340 POKEY,236:CH=236:GOTO130
400 N=X
401 TY=255
405 C=120
406 FORG=Y+A*2 TO Y+(A*8)*2 STEP A*2
407 IFPEEK(G)=226ORPEEK(G)=111THEN600
408 G=G-A:IFPEEK(G)=226ORPEEK(G)=111THEN600
409 G=G+A:POKE57089,TY:TY=TY-10
410 POKEG,C
415 ST=1:GOTO2000
420 IFA(N)<>546THENPOKEA(N),32:A(N)=A(N)+S(N):POKEA(N),C(N)
421 ST=0
425 N=N+1:IFN=LE+1THENN=1
426 POKE57089,0
430 POKEG,32:NEXTG
440 GOTO130
500 POKEY,32:G=Y:FL=1:GOSUB600
502 FL=0
506 AM=AM-1
507 IFAM=0THEN520
510 Y=54160:GOTO130
520 I=USR(I)
530 PRINT"TOO BAD...  YOUR CHANCES OF REACHING EARTH HAVE NOW"
540 PRINT"DIMINISHED TO NOTHING, BETTER LUCK NEXT TIME!"
550 GOTO760
600 IFFL=0THENPOKEG,32
601 IFN>LE+0THENN=1
605 FORJ=1TOLE
606 T=INT(J/3)
607 POKE57089,256*RND(1)
610 POKEG+(T*-64),46
620 POKEG+T,46
630 POKEG+(T*65),46
635 IFFL=0THENPOKEY,CH
640 IFA(N)=GTHENLK=N:GOTO645
641 POKEA(N),32:IFA(N)<>546THENA(N)=A(N)+S(N):POKEA(N),C(N)
645 N=N+1:IFN=LE+1THENN=1
646 IFFL=0THEN2000
650 POKEG+(T*-64),32
660 POKEG+T,32
670 POKEG+(T*65),32
675 IFFL=0THENPOKEY,CH
680 NEXTJ
685 POKE57089,0
690 IFFL=1THENRETURN
695 A(LK)=546
696 ME=ME-1:IFME=0THEN700
697 IFFL=0ANDUI=1THENUI=0:GOTO500
699 GOTO130
700 PRINT"CONGRATULATIONS!! YOU MADE IT SAFELY BACK TO EARTH!"
705 PRINT
710 IFAM<>3THEN750
720 PRINT".. AND THE MOST AMAZING THING ABOUT IT IS THAT YOU"
730 PRINT"ONLY USED ONE SHIP!!"
740 PRINT"          ";CHR$(135);CHR$(135);CHR$(135);:GOTO760
750 PRINT"AND YOU ONLY USED"4-AM"SHIPS GETTING BACK HERE!"
760 PRINT:PRINT:INPUT"PLAY AGAIN";A$
770 IFLEFT$(A$,1)="Y"THENRUN
780 END:GOTO 780
800 DIMA(LE),S(LE),C(LE)
801 D(1)=226:D(2)=111:FORT=1TO6:READB(T):NEXTT
802 DATA-64,64,65,-65,63,-63
810 Y=54160
820 K=1024:N=8:B=K*N:C=B/256-1:POKE11,232:POKE12,C
830 READA$:IFA$<>"GO"THENPRINTA$:GOTO830
840 FORP=B-24TOB-1:READM:POKEP,M:NEXTP
850 POKEB-2,C:POKEB-10,C
860 I=USR(I)
870 GOTO910
875 DATA "GO"
880 DATA 169,32,160,8,162,0,157,0,208
890 DATA 232,208,250,238,240,15,136,208,244,169,208
900 DATA 141,240,15,96
910 PRINT"ASTEROID BELT":PRINT:PRINT"BY COREY OSTMAN"
920 FORG=1TO5:PRINT:NEXTG
930 INPUT"WANT INSTRUCTIONS";A$
940 IFLEFT$(A$,1)="Y"THEN1000
960 POKE11,232:POKE12,C:I=USR(I):RETURN
1000 POKE15,0:POKE530,1
1005 I=USR(I)
1010 PRINT"  YOU ARE THE ONLY SURVIVOR ABORD THE JUPITER-3"
1020 PRINT"STAR-BASE, IN ORDER TO SURVIVE YOU MUST USE THE"
1030 PRINT"THREE REMAINING SHIPS IN THE HANGER TO GET BACK"
1040 PRINT"TO EARTH. THIS TASK WILL NOT BE EASY ON ACCOUNT"
1050 PRINT"OF HUGE ASTEROIDS THAT MUST BE DESTROYED BEFORE"
1060 PRINT"YOU CAN GET BACK TO EARTH......."
1065 POKE15,72
1066 PRINT:PRINT:PRINT
1070 PRINT"USE THESE CONTROLS TO FIRE AND TO MOVE:"
1080 PRINT"<1>   MOVES YOUR SPACESHIP DOWN"
1090 PRINT"<2>   MOVES YOUR SPACESHIP UP"
1100 PRINT"<3>   MOVES YOUR SPACESHIP RIGHT"
1110 PRINT"<4>   MOVES YOUR SPACESHIP LEFT"
1120 PRINT"<5>   FIRES PHOTON TORPEDOES"
1130 PRINT:PRINT
1140 PRINT"TYPE <RETURN> TO START? ";:POKE11,0:POKE12,253
1150 I=USR(I):IFPEEK(531)<>13THEN1150
1160 PRINT:GOTO960
2000 POKEK,128:P=PEEK(K):IFP=128THENA=64:CH=238:GOTO2009
2001 IFP=64THENA=-64:CH=236:GOTO2009
2002 IFP=32THENA=1:CH=237:GOTO2009
2003 IFP=16THENA=-1:CH=239:GOTO2009
2009 POKEY,32
2010 IFY+A<53696THENY=Y+1408
2020 IFY+A>55104THENY=Y-1408
2030 Y=Y+A:IFST=1ANDPEEK(Y)<>32THENPOKEG,32:GOTO500
2031 IFFL=0ANDPEEK(Y)>100THENA=0:UI=1
2034 POKEY,CH
2035 IFST=1THEN420
2040 IFFL=0THEN650
